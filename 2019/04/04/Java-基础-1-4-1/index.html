<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Java 字符串(一) | 平心de小屋</title><meta name="keywords" content="Java"><meta name="author" content="平心"><meta name="copyright" content="平心"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="字符串在java中所有以双引号包括的零个或多个字符都是字符串，可以认为是String类，例如： 123&quot;Hello&quot;&quot;&quot;&quot;12315 \n&quot; 单引号包括的就是字符，只能有一个字符，可以认为时Character类。例如： 123&amp;#x27;1&amp;#x27;&amp;#x27;H&amp;#x27;&amp;#x27;&amp;#x27;">
<meta property="og:type" content="article">
<meta property="og:title" content="Java 字符串(一)">
<meta property="og:url" content="https://pingxin0521.gitee.io/2019/04/04/Java-%E5%9F%BA%E7%A1%80-1-4-1/index.html">
<meta property="og:site_name" content="平心de小屋">
<meta property="og:description" content="字符串在java中所有以双引号包括的零个或多个字符都是字符串，可以认为是String类，例如： 123&quot;Hello&quot;&quot;&quot;&quot;12315 \n&quot; 单引号包括的就是字符，只能有一个字符，可以认为时Character类。例如： 123&amp;#x27;1&amp;#x27;&amp;#x27;H&amp;#x27;&amp;#x27;&amp;#x27;">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i.loli.net/2020/05/08/okfOw28KlZFbE7z.jpg">
<meta property="article:published_time" content="2019-04-04T12:18:59.000Z">
<meta property="article:modified_time" content="2019-09-24T04:46:49.000Z">
<meta property="article:author" content="平心">
<meta property="article:tag" content="Java">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2020/05/08/okfOw28KlZFbE7z.jpg"><link rel="shortcut icon" href="https://s2.ax1x.com/2020/02/11/1ovFOA.png"><link rel="canonical" href="https://pingxin0521.gitee.io/2019/04/04/Java-%E5%9F%BA%E7%A1%80-1-4-1/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: true,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Java 字符串(一)',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2019-09-24 12:46:49'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    })(window)</script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://s2.ax1x.com/2020/02/11/1ovw6J.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">449</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">77</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">68</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://i.loli.net/2020/05/08/okfOw28KlZFbE7z.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">平心de小屋</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Java 字符串(一)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2019-04-04T12:18:59.000Z" title="发表于 2019-04-04 20:18:59">2019-04-04</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2019-09-24T04:46:49.000Z" title="更新于 2019-09-24 12:46:49">2019-09-24</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Java/">Java</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Java/%E5%9F%BA%E7%A1%80/">基础</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">7.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>28分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Java 字符串(一)"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h3 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h3><p>在java中所有以双引号包括的零个或多个字符都是字符串，可以认为是String类，例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&quot;Hello&quot;</span><br><span class="line">&quot;&quot;</span><br><span class="line">&quot;12315 \n&quot;</span><br></pre></td></tr></table></figure>
<p>单引号包括的就是字符，只能有一个字符，可以认为时Character类。例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#x27;1&#x27;</span><br><span class="line">&#x27;H&#x27;</span><br><span class="line">&#x27;&#x27;</span><br></pre></td></tr></table></figure>

<span id="more"></span>

<blockquote>
<p>注:Java中一切都可以被当做对象</p>
</blockquote>
<p>首先我们要明确，String并不是基本数据类型，而是一个对象，并且是不可变的对象。查看源码就会发现String类为final型的（当然也不可被继承），而且通过查看JDK文档会发现几乎每一个修改String对象的操作，实际上都是创建了一个全新的String对象。</p>
<p><strong>字符串的声明：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String str；</span><br></pre></td></tr></table></figure>
<p>默认是等于null，必须经过初始化才能使用。</p>
<p><strong>字符串创建：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">String str1=&quot;hello 123&quot;; //直接声明，在堆中创建字符串常量&quot;hello 123&quot;，str1是该字符串的引用，</span><br><span class="line">char c[]=&#123;&#x27;h&#x27;,&#x27;e&#x27;,&#x27;l&#x27;,&#x27;l&#x27;,&#x27;o&#x27;&#125;;</span><br><span class="line">String str2=new String(c); //使用字符数组填充值，和下面一个等价</span><br><span class="line">String str3=new String(&quot;hello&quot;);//创建对象</span><br><span class="line"></span><br><span class="line">int offset=1;//偏移量</span><br><span class="line">int length=2;//长度</span><br><span class="line">String str4=new String(c,offset,length); //el</span><br></pre></td></tr></table></figure>


<p><strong>字符串连接</strong></p>
<p>使用’+’运算符就可以实现链接多个字符串的功能，连接后创建一个新的String对象。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">String str1 =new String(&quot;hello&quot;);</span><br><span class="line">String str2=new String(&quot;123&quot;);</span><br><span class="line"></span><br><span class="line">String s=str1+&quot; &quot;+str2;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>一句相连的字符串不能分开在两行中</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">String str1 =new String(&quot;hello</span><br><span class="line">        123 &quot;);//错误</span><br><span class="line"></span><br><span class="line">//推荐,使用这个控制代码行长度</span><br><span class="line">String str1 =new String(&quot;hello&quot;+</span><br><span class="line">        &quot;123 &quot;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>上面显示的是拼接字符串，其实’+’可以拼接字符串和其他类型、其他类型和字符串、复杂类型等。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">String s1=&quot;hello&quot;+123;//字符串拼接数字，值&quot;hello123&quot;</span><br><span class="line">String s2=&quot;hello&quot;+123f;//字符串拼接float数字,值&quot;hello123.0&quot;</span><br><span class="line">String s3=&quot;hello&quot;+true;//字符串拼接布尔,值&quot;hellotrue&quot;</span><br><span class="line"></span><br><span class="line">String s4=1+2+3+&quot;hello&quot;;//数字拼接字符串，前面&#x27;+&#x27;是加法运算符，后面是字符串拼接符号,值&quot;6hello&quot;</span><br><span class="line"></span><br><span class="line">String s5=1+2+&quot;hello&quot;+3+6;//复杂类型，前面&#x27;+&#x27;是加法运算符，后面是字符串拼接符号,值&quot;3hello36&quot;</span><br><span class="line"></span><br><span class="line">String s6=1+3+&quot;hello&quot;+(3+6) //使用小括号，值&quot;4hello9&quot;。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="String类"><a href="#String类" class="headerlink" title="String类"></a>String类</h3><p>字符串广泛应用 在Java 编程中，在 Java 中字符串属于对象，Java 提供了 String 类来创建和操作字符串。</p>
<h4 id="常用方法"><a href="#常用方法" class="headerlink" title="常用方法"></a>常用方法</h4><ol>
<li>构造方法：</li>
</ol>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">* public String():创建String对象</span><br><span class="line">*	public String(byte[] bytes):把字节数组转成字符串。</span><br><span class="line">*	public String(byte[] bytes,int index,int length):把字节数组中的一部分转成字符串</span><br><span class="line">*	public String(char[] value):把字符数组转成字符串</span><br><span class="line">*	public String(char[] value,int index,int count):把字符数组的一部分转成字符串</span><br><span class="line">* public String(String original):把字符串转成字符串</span><br></pre></td></tr></table></figure>
<p> 注意问题：</p>
<ul>
<li><p>输出语句输出任何对象名称的时候，默认调用的是该对象的toString()方法。</p>
<p>而toString()方法默认输出的是包名…类名@哈希值的十六进制。</p>
<p>如果，你用输出语句输出一个对象名称的时候，发现不是这个格式，说明了该类或者该类的父类重写了toString()方法。</p>
</li>
</ul>
<ul>
<li>返回此字符串的长度</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public int length()</span><br></pre></td></tr></table></figure>

<ol start="2">
<li><p>==：比较的是引用类型，比较的是地址值即：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">System.out.println(s1 == s2); // false</span><br><span class="line">equal():默认比较的是地址值。String类重写了equals()方法，该方法的作用是比较字符串的内容是否相同</span><br><span class="line">System.out.println(s1.equals(s2)); // true</span><br></pre></td></tr></table></figure></li>
<li><p>字符串变量相加：先开空间，再加内容；字符串常量相加：先加，再找，没有再开空间</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">String s1 = &quot;hello&quot;;</span><br><span class="line">String s2 = &quot;world&quot;;</span><br><span class="line">String s3 = &quot;helloworld&quot;;</span><br><span class="line">String s4 = s1 + s2;</span><br><span class="line">String s5 = &quot;hello&quot;+&quot;world&quot;;</span><br><span class="line">// 即s4和s5的区别。</span><br></pre></td></tr></table></figure></li>
<li><p>String类的判断功能：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">boolean equals(Object obj):比较字符串的内容是否相同，严格区分大小写</span><br><span class="line">boolean equalsIgnoreCase(String str):比较字符串的内容是否相同，不考虑大小写</span><br><span class="line">boolean contains(String str):判断是否包含指定的小串</span><br><span class="line">boolean startsWith(String str):判断是否以指定的字符串开头</span><br><span class="line">boolean endsWith(String str):判断是否以指定的字符串结尾</span><br><span class="line">boolean isEmpty():判断字符串的内容是否为空</span><br></pre></td></tr></table></figure></li>
<li><p>String类的获取功能：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">int length():返回字符串的长度。字符的个数。</span><br><span class="line">char charAt(int index):返回字符串中指定位置的字符。</span><br><span class="line">int indexOf(int ch):返回指定字符在字符串中第一次出现的位置</span><br><span class="line">int indexOf(String str):返回指定字符串在字符串中第一次出现的位置</span><br><span class="line">int indexOf(int ch,int fromIndex):返回指定字符从指定位置开始在字符串中第一次出现的位置</span><br><span class="line">int indexOf(String str,int fromIndex):返回指定字符串从指定位置开始在字符串中第一次出现的位置</span><br><span class="line">String substring(int start):返回从指定位置开始到末尾的子串</span><br><span class="line">String substring(int start,int end):返回从指定位置开始到指定位置结束的子串----注意左包右不包,</span><br><span class="line">即[start,end);</span><br></pre></td></tr></table></figure></li>
<li><p>String的转换功能：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">byte[] getBytes():把字符串转换为字节数组</span><br><span class="line">char[] toCharArray():把字符串转换为字符数组</span><br><span class="line">static String valueOf(char[] chs):把字符数组转成字符串</span><br><span class="line">static String valueOf(int i):把int类型的数据转成字符串</span><br><span class="line">//把任意类型转换为字符串的方法,省略</span><br><span class="line">String toLowerCase():把字符串转小写</span><br><span class="line">String toUpperCase():把字符串转大写</span><br><span class="line">String concat(String str):字符串的连接</span><br></pre></td></tr></table></figure></li>
<li><p>替换功能：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">String replace(char old,char new)</span><br><span class="line">String replace(String old,String new)</span><br></pre></td></tr></table></figure></li>
<li><p>去除字符串两侧空格：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String trim()</span><br></pre></td></tr></table></figure></li>
<li><p>按字典顺序比较两个字符串  a-z</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">int compareTo(String str)</span><br><span class="line">int compareToIgnoreCase(String str)</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="格式化字符串"><a href="#格式化字符串" class="headerlink" title="格式化字符串"></a>格式化字符串</h4><p><strong>参考即可,不用记忆</strong></p>
<p>String类的format()方法用于创建格式化的字符串以及连接多个字符串对象。熟悉C语言的同学应该记得C语言的sprintf()方法，两者有类似之处。format()方法有两种重载形式。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">format(String format, Object... args) 新字符串使用本地语言环境，制定字符串格式和参数生成格式化的新字符串。</span><br><span class="line">format(Locale locale, String format, Object... args) 使用指定的语言环境，制定字符串格式和参数生成格式化的字符串。</span><br></pre></td></tr></table></figure>
<p>显示不同转换符实现不同数据类型到字符串的转换，如图所示<br><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://i.loli.net/2019/04/09/5cac38caf12a9.png"><br>示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    String str=<span class="keyword">null</span>;</span><br><span class="line">    str=String.format(<span class="string">&quot;Hi,%s&quot;</span>, <span class="string">&quot;平心&quot;</span>);</span><br><span class="line">    System.out.println(str);</span><br><span class="line">    str=String.format(<span class="string">&quot;Hi,%s:%s.%s&quot;</span>, <span class="string">&quot;平&quot;</span>,<span class="string">&quot;心&quot;</span>,<span class="string">&quot;韩&quot;</span>);</span><br><span class="line">    System.out.println(str);</span><br><span class="line">    System.out.printf(<span class="string">&quot;字母a的大写是：%c %n&quot;</span>, <span class="string">&#x27;A&#x27;</span>);</span><br><span class="line">    System.out.printf(<span class="string">&quot;3&gt;7的结果是：%b %n&quot;</span>, <span class="number">3</span>&gt;<span class="number">7</span>);</span><br><span class="line">    System.out.printf(<span class="string">&quot;100的一半是：%d %n&quot;</span>, <span class="number">100</span>/<span class="number">2</span>);</span><br><span class="line">    System.out.printf(<span class="string">&quot;100的16进制数是：%x %n&quot;</span>, <span class="number">100</span>);</span><br><span class="line">    System.out.printf(<span class="string">&quot;100的8进制数是：%o %n&quot;</span>, <span class="number">100</span>);</span><br><span class="line">    System.out.printf(<span class="string">&quot;50元的书打8.5折扣是：%f 元%n&quot;</span>, <span class="number">50</span>*<span class="number">0.85</span>);</span><br><span class="line">    System.out.printf(<span class="string">&quot;上面价格的16进制数是：%a %n&quot;</span>, <span class="number">50</span>*<span class="number">0.85</span>);</span><br><span class="line">    System.out.printf(<span class="string">&quot;上面价格的指数表示：%e %n&quot;</span>, <span class="number">50</span>*<span class="number">0.85</span>);</span><br><span class="line">    System.out.printf(<span class="string">&quot;上面价格的指数和浮点数结果的长度较短的是：%g %n&quot;</span>, <span class="number">50</span>*<span class="number">0.85</span>);</span><br><span class="line">    System.out.printf(<span class="string">&quot;上面的折扣是%d%% %n&quot;</span>, <span class="number">85</span>);</span><br><span class="line">    System.out.printf(<span class="string">&quot;字母A的散列码是：%h %n&quot;</span>, <span class="string">&#x27;A&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ java TestString</span><br><span class="line">Hi,平心</span><br><span class="line">Hi,平:心.韩</span><br><span class="line">字母a的大写是：A</span><br><span class="line">3&gt;7的结果是：false</span><br><span class="line">100的一半是：50</span><br><span class="line">100的16进制数是：64</span><br><span class="line">100的8进制数是：144</span><br><span class="line">50元的书打8.5折扣是：42.500000 元</span><br><span class="line">上面价格的16进制数是：0x1.54p5</span><br><span class="line">上面价格的指数表示：4.250000e+01</span><br><span class="line">上面价格的指数和浮点数结果的长度较短的是：42.5000</span><br><span class="line">上面的折扣是85%</span><br><span class="line">字母A的散列码是：41</span><br></pre></td></tr></table></figure>
<p><strong>搭配转换符的标志</strong></p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://i.loli.net/2019/04/09/5cac3b223da50.png"><br>示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">public static void main(String[] args) &#123;</span><br><span class="line">    String str=null;</span><br><span class="line">    //$使用</span><br><span class="line">    str=String.format(&quot;格式参数$的使用：%1$d,%2$s&quot;, 99,&quot;abc&quot;);</span><br><span class="line">    System.out.println(str);</span><br><span class="line">    //+使用</span><br><span class="line">    System.out.printf(&quot;显示正负数的符号：%+d与%d%n&quot;, 99,-99);</span><br><span class="line">    //补O使用</span><br><span class="line">    System.out.printf(&quot;最牛的编号是：%03d%n&quot;, 7);</span><br><span class="line">    //空格使用</span><br><span class="line">    System.out.printf(&quot;Tab键的效果是：% 8d%n&quot;, 7);</span><br><span class="line">    //.使用</span><br><span class="line">    System.out.printf(&quot;整数分组的效果是：%,d%n&quot;, 9989997);</span><br><span class="line">    //空格和小数点后面个数</span><br><span class="line">    System.out.printf(&quot;一本书的价格是：% 50.5f元%n&quot;, 49.8);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ java TestString</span><br><span class="line">格式参数$的使用：99,abc</span><br><span class="line">显示正负数的符号：+99与-99</span><br><span class="line">最牛的编号是：007</span><br><span class="line">Tab键的效果是：       7</span><br><span class="line">整数分组的效果是：9,989,997</span><br><span class="line">一本书的价格是：                                          49.80000元</span><br></pre></td></tr></table></figure>
<p><strong>日期和事件字符串格式化</strong><br>在程序界面中经常需要显示时间和日期，但是其显示的 格式经常不尽人意，需要编写大量的代码经过各种算法才得到理想的日期与时间格式。字符串格式中还有%tx转换符没有详细介绍，它是专门用来格式化日期和时间的。%tx转换符中的x代表另外的处理日期和时间格式的转换符，它们的组合能够将日期和时间格式化成多种格式。</p>
<p>常见日期和时间组合的格式，如图所示。</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://i.loli.net/2019/04/09/5cac3c926dbe0.png"></p>
<p>示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">//需要导入`import java.util.Date;`</span><br><span class="line"></span><br><span class="line">public static void main(String[] args) &#123;</span><br><span class="line">    Date date=new Date();</span><br><span class="line">    //c的使用</span><br><span class="line">    System.out.printf(&quot;全部日期和时间信息：%tc%n&quot;,date);</span><br><span class="line">    //f的使用</span><br><span class="line">    System.out.printf(&quot;年-月-日格式：%tF%n&quot;,date);</span><br><span class="line">    //d的使用</span><br><span class="line">    System.out.printf(&quot;月/日/年格式：%tD%n&quot;,date);</span><br><span class="line">    //r的使用</span><br><span class="line">    System.out.printf(&quot;HH:MM:SS PM格式（12时制）：%tr%n&quot;,date);</span><br><span class="line">    //t的使用</span><br><span class="line">    System.out.printf(&quot;HH:MM:SS格式（24时制）：%tT%n&quot;,date);</span><br><span class="line">    //R的使用</span><br><span class="line">    System.out.printf(&quot;HH:MM格式（24时制）：%tR&quot;,date);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ java TestString</span><br><span class="line">全部日期和时间信息：星期二 四月 09 14:42:50 CST 2019</span><br><span class="line">年-月-日格式：2019-04-09</span><br><span class="line">月/日/年格式：04/09/19</span><br><span class="line">HH:MM:SS PM格式（12时制）：02:42:50 下午</span><br><span class="line">HH:MM:SS格式（24时制）：14:42:50</span><br><span class="line">HH:MM格式（24时制）：14:42</span><br></pre></td></tr></table></figure>
<p>定义日期格式的转换符可以使日期通过指定的转换符生成新字符串。这些日期转换符如图所示。</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://s2.ax1x.com/2019/06/23/Ziivxe.png" alt="Ziivxe.png"></p>
<p>示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    Date date=<span class="keyword">new</span> Date();</span><br><span class="line">    <span class="comment">//b的使用，月份简称</span></span><br><span class="line">    String str=String.format(Locale.US,<span class="string">&quot;英文月份简称：%tb&quot;</span>,date);</span><br><span class="line">    System.out.println(str);</span><br><span class="line">    System.out.printf(<span class="string">&quot;本地月份简称：%tb%n&quot;</span>,date);</span><br><span class="line">    <span class="comment">//B的使用，月份全称</span></span><br><span class="line">    str=String.format(Locale.US,<span class="string">&quot;英文月份全称：%tB&quot;</span>,date);</span><br><span class="line">    System.out.println(str);</span><br><span class="line">    System.out.printf(<span class="string">&quot;本地月份全称：%tB%n&quot;</span>,date);</span><br><span class="line">    <span class="comment">//a的使用，星期简称</span></span><br><span class="line">    str=String.format(Locale.US,<span class="string">&quot;英文星期的简称：%ta&quot;</span>,date);</span><br><span class="line">    System.out.println(str);</span><br><span class="line">    <span class="comment">//A的使用，星期全称</span></span><br><span class="line">    System.out.printf(<span class="string">&quot;本地星期的简称：%tA%n&quot;</span>,date);</span><br><span class="line">    <span class="comment">//C的使用，年前两位</span></span><br><span class="line">    System.out.printf(<span class="string">&quot;年的前两位数字（不足两位前面补0）：%tC%n&quot;</span>,date);</span><br><span class="line">    <span class="comment">//y的使用，年后两位</span></span><br><span class="line">    System.out.printf(<span class="string">&quot;年的后两位数字（不足两位前面补0）：%ty%n&quot;</span>,date);</span><br><span class="line">    <span class="comment">//j的使用，一年的天数</span></span><br><span class="line">    System.out.printf(<span class="string">&quot;一年中的天数（即年的第几天）：%tj%n&quot;</span>,date);</span><br><span class="line">    <span class="comment">//m的使用，月份</span></span><br><span class="line">    System.out.printf(<span class="string">&quot;两位数字的月份（不足两位前面补0）：%tm%n&quot;</span>,date);</span><br><span class="line">    <span class="comment">//d的使用，日（二位，不够补零）</span></span><br><span class="line">    System.out.printf(<span class="string">&quot;两位数字的日（不足两位前面补0）：%td%n&quot;</span>,date);</span><br><span class="line">    <span class="comment">//e的使用，日（一位不补零）</span></span><br><span class="line">    System.out.printf(<span class="string">&quot;月份的日（前面不补0）：%te&quot;</span>,date);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>输出结果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">英文月份简称：Sep</span><br><span class="line">本地月份简称：九月</span><br><span class="line">英文月份全称：September</span><br><span class="line">本地月份全称：九月</span><br><span class="line">英文星期的简称：Mon</span><br><span class="line">本地星期的简称：星期一</span><br><span class="line">年的前两位数字（不足两位前面补0）：20</span><br><span class="line">年的后两位数字（不足两位前面补0）：12</span><br><span class="line">一年中的天数（即年的第几天）：254</span><br><span class="line">两位数字的月份（不足两位前面补0）：09</span><br><span class="line">两位数字的日（不足两位前面补0）：10</span><br><span class="line">月份的日（前面不补0）：10</span><br></pre></td></tr></table></figure>
<p>和日期格式转换符相比，时间格式的转换符要更多、更精确。它可以将时间格式化成时、分、秒甚至时毫秒等单位。格式化时间字符串的转换符如图所示。<br><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://s2.ax1x.com/2019/06/23/Zik9lF.png" alt="Zik9lF.png"></p>
<p>示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">public static void main(String[] args) &#123;</span><br><span class="line">    Date date = new Date();</span><br><span class="line">    //H的使用</span><br><span class="line">    System.out.printf(&quot;2位数字24时制的小时（不足2位前面补0）:%tH%n&quot;, date);</span><br><span class="line">    //I的使用</span><br><span class="line">    System.out.printf(&quot;2位数字12时制的小时（不足2位前面补0）:%tI%n&quot;, date);</span><br><span class="line">    //k的使用</span><br><span class="line">    System.out.printf(&quot;2位数字24时制的小时（前面不补0）:%tk%n&quot;, date);</span><br><span class="line">    //l的使用</span><br><span class="line">    System.out.printf(&quot;2位数字12时制的小时（前面不补0）:%tl%n&quot;, date);</span><br><span class="line">    //M的使用</span><br><span class="line">    System.out.printf(&quot;2位数字的分钟（不足2位前面补0）:%tM%n&quot;, date);</span><br><span class="line">    //S的使用</span><br><span class="line">    System.out.printf(&quot;2位数字的秒（不足2位前面补0）:%tS%n&quot;, date);</span><br><span class="line">    //L的使用</span><br><span class="line">    System.out.printf(&quot;3位数字的毫秒（不足3位前面补0）:%tL%n&quot;, date);</span><br><span class="line">    //N的使用</span><br><span class="line">    System.out.printf(&quot;9位数字的毫秒数（不足9位前面补0）:%tN%n&quot;, date);</span><br><span class="line">    //p的使用</span><br><span class="line">    String str = String.format(Locale.US, &quot;小写字母的上午或下午标记(英)：%tp&quot;, date);</span><br><span class="line">    System.out.println(str);</span><br><span class="line">    System.out.printf(&quot;小写字母的上午或下午标记（中）：%tp%n&quot;, date);</span><br><span class="line">    //z的使用</span><br><span class="line">    System.out.printf(&quot;相对于GMT的RFC822时区的偏移量:%tz%n&quot;, date);</span><br><span class="line">    //Z的使用</span><br><span class="line">    System.out.printf(&quot;时区缩写字符串:%tZ%n&quot;, date);</span><br><span class="line">    //s的使用</span><br><span class="line">    System.out.printf(&quot;1970-1-1 00:00:00 到现在所经过的秒数：%ts%n&quot;, date);</span><br><span class="line">    //Q的使用</span><br><span class="line">    System.out.printf(&quot;1970-1-1 00:00:00 到现在所经过的毫秒数：%tQ%n&quot;, date);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>输出结果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">2位数字24时制的小时（不足2位前面补0）:11</span><br><span class="line">2位数字12时制的小时（不足2位前面补0）:11</span><br><span class="line">2位数字24时制的小时（前面不补0）:11</span><br><span class="line">2位数字12时制的小时（前面不补0）:11</span><br><span class="line">2位数字的分钟（不足2位前面补0）:03</span><br><span class="line">2位数字的秒（不足2位前面补0）:52</span><br><span class="line">3位数字的毫秒（不足3位前面补0）:773</span><br><span class="line">9位数字的毫秒数（不足9位前面补0）:773000000</span><br><span class="line">小写字母的上午或下午标记(英)：am</span><br><span class="line">小写字母的上午或下午标记（中）：上午</span><br><span class="line">相对于GMT的RFC822时区的偏移量:+0800</span><br><span class="line">时区缩写字符串:CST</span><br><span class="line">1970-1-1 00:00:00 到现在所经过的秒数：1347246232</span><br><span class="line">1970-1-1 00:00:00 到现在所经过的毫秒数：1347246232773</span><br></pre></td></tr></table></figure>

<h4 id="StringBuilder"><a href="#StringBuilder" class="headerlink" title="StringBuilder"></a>StringBuilder</h4><p>在程序开发过程中，我们常常碰到字符串连接的情况，方便和直接的方式是通过”+”符号来实现，但是这种方式达到目的的效率比较低，且每执行一次都会创建一个String对象，即耗时，又浪费空间。使用StringBuilder类就可以避免这种问题的发生，下面就Stringbuilder的使用做个简要的总结：</p>
<p>创建Stringbuilder对象</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">StringBuilder strB = new StringBuilder();</span><br><span class="line">StringBuilder strB = new StringBuilder(&quot;abc&quot;);</span><br></pre></td></tr></table></figure>

<ol>
<li><p> append(String str)/append(Char c)：字符串连接</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">System.out.println(&quot;StringBuilder:&quot;+strB.append(&quot;ch&quot;).append(&quot;111&quot;).append(&#x27;c&#x27;));</span><br><span class="line">//return “StringBuilder:ch111c”</span><br></pre></td></tr></table></figure></li>
<li><p>toString()：返回一个与构建起或缓冲器内容相同的字符串</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">System.out.println(&quot;String:&quot;+strB.toString());</span><br><span class="line">//return “String:ch111c”</span><br></pre></td></tr></table></figure></li>
<li><p>appendcodePoint(int cp)：追加一个代码点，并将其转换为一个或两个代码单元并返回this</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">System.out.println(&quot;StringBuilder.appendCodePoint:&quot;+strB.appendCodePoint(2));</span><br><span class="line">//return “StringBuilder.appendCodePoint:ch111c[]”</span><br></pre></td></tr></table></figure></li>
<li><p>setCharAt(int i, char c)：将第 i 个代码单元设置为 c（可以理解为替换）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">strB.setCharAt(2, &#x27;d&#x27;);</span><br><span class="line">System.out.println(&quot;StringBuilder.setCharAt:&quot; + strB);</span><br><span class="line">//return “StringBuilder.setCharAt:chd11c[]”</span><br></pre></td></tr></table></figure></li>
<li><p>insert(int offset, String str)/insert(int offset, Char c)：在指定位置之前插入字符(串)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">System.out.println(&quot;StringBuilder.insertString:&quot;+ strB.insert(2, &quot;LS&quot;));</span><br><span class="line">//return “StringBuilder.insertString:chLSd11c[]”</span><br><span class="line">System.out.println(&quot;StringBuilder.insertString:&quot;+ strB.insert(2, &#x27;L&#x27;));</span><br><span class="line">//return “StringBuilder.insertChar:chLLSd11c[]”</span><br></pre></td></tr></table></figure></li>
<li><p>delete(int startIndex,int endIndex)：删除起始位置（含）到结尾位置（不含）之间的字符串</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">System.out.println(“StringBuilder.delete:”+ strB.delete(2, 4));</span><br><span class="line">//return “StringBuilder.delete:chSd11c[]”</span><br></pre></td></tr></table></figure></li>
</ol>
<p><strong>StringBuilder是线程不安全的。</strong></p>
<h4 id="StringBuffer类"><a href="#StringBuffer类" class="headerlink" title="StringBuffer类"></a>StringBuffer类</h4><p>StringBuffer类和String一样，也用来代表字符串，只是由于StringBuffer的内部实现方式和String不同，所以StringBuffer在进行字符串处理时，不生成新的对象，在内存使用上要优于String类。</p>
<p>所以在实际使用时，如果经常需要对一个字符串进行修改，例如插入、删除等操作，使用StringBuffer要更加适合一些。</p>
<p>在StringBuffer类中存在很多和String类一样的方法，这些方法在功能上和String类中的功能是完全一样的。</p>
<p>但是有一个最显著的区别在于，对于StringBuffer对象的每次修改都会改变对象自身，这点是和String类最大的区别。</p>
<p>另外由于StringBuffer是线程安全的，关于线程的概念后续有专门的章节进行介绍，所以在多线程程序中也可以很方便的进行使用，但是程序的执行效率相对来说就要稍微慢一些。</p>
<p><strong>StringBuffer对象的初始化</strong></p>
<p>StringBuffer对象的初始化不像String类的初始化一样，Java提供的有特殊的语法，而通常情况下一般使用构造方法进行初始化。</p>
<p>例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">StringBuffer s = new StringBuffer();</span><br></pre></td></tr></table></figure>
<p>这样初始化出的StringBuffer对象是一个空的对象。<br>如果需要创建带有内容的StringBuffer对象，则可以使用：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">StringBuffer s = new StringBuffer(“abc”);</span><br></pre></td></tr></table></figure>
<p>这样初始化出的StringBuffer对象的内容就是字符串”abc”。<br>需要注意的是，StringBuffer和String属于不同的类型，也不能直接进行强制类型转换，下面的代码都是错误的：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">StringBuffer s = “abc”;               //赋值类型不匹配</span><br><span class="line">StringBuffer s = (StringBuffer)”abc”;    //不存在继承关系，无法进行强转</span><br></pre></td></tr></table></figure>
<p>StringBuffer对象和String对象之间的互转的代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">String s = “abc”;</span><br><span class="line">StringBuffer sb1 = new StringBuffer(“123”);</span><br><span class="line">StringBuffer sb2 = new StringBuffer(s);   //String转换为StringBuffer</span><br><span class="line">String s1 = sb1.toString();              //StringBuffer转换为String</span><br></pre></td></tr></table></figure>
<p>StringBuffer() 构造一个空的字符串缓冲区，并且初始化为 16 个字符的容量。<br>StringBuffer(int length) 创建一个空的字符串缓冲区，并且初始化为指定长度 length 的容量。<br>StringBuffer(String str) 创建一个字符串缓冲区，并将其内容初始化为指定的字符串内容 str，字符串缓冲区的初始容量为 16 加上字符串 str 的长度。</p>
<p>对于StringBuffer而言不可直接强制类型转化，即StringBuffer a=（StringBuffer）‘ac’是错误的使用方法。<br>对于StringBuffer转化为String可使用 String b=a.toString(），对于String转为StringBuffer可使用StringBuffer b=new StringBuffer(string)</p>
<p><strong>常用函数使用：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UsingStringBuffer</span> </span>&#123;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 查找匹配字符串</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">testFindStr</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	StringBuffer sb = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">	sb.append(<span class="string">&quot;This is a StringBuffer&quot;</span>);</span><br><span class="line">	<span class="comment">// 返回子字符串在字符串中最先出现的位置，如果不存在，返回负数</span></span><br><span class="line">	System.out.println(<span class="string">&quot;sb.indexOf(\&quot;is\&quot;)=&quot;</span> + sb.indexOf(<span class="string">&quot;is&quot;</span>));</span><br><span class="line">	<span class="comment">// 给indexOf方法设置参数，指定匹配的起始位置</span></span><br><span class="line">	System.out.println(<span class="string">&quot;sb.indexOf(\&quot;is\&quot;)=&quot;</span> + sb.indexOf(<span class="string">&quot;is&quot;</span>, <span class="number">3</span>));</span><br><span class="line">	<span class="comment">// 返回子字符串在字符串中最后出现的位置，如果不存在，返回负数</span></span><br><span class="line">	System.out.println(<span class="string">&quot;sb.lastIndexOf(\&quot;is\&quot;) = &quot;</span> + sb.lastIndexOf(<span class="string">&quot;is&quot;</span>));</span><br><span class="line">	<span class="comment">// 给lastIndexOf方法设置参数，指定匹配的结束位置</span></span><br><span class="line">	System.out.println(<span class="string">&quot;sb.lastIndexOf(\&quot;is\&quot;, 1) = &quot;</span></span><br><span class="line">			+ sb.lastIndexOf(<span class="string">&quot;is&quot;</span>, <span class="number">1</span>));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 截取字符串</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">testSubStr</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	StringBuffer sb = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">	sb.append(<span class="string">&quot;This is a StringBuffer&quot;</span>);</span><br><span class="line">	<span class="comment">// 默认的终止位置为字符串的末尾</span></span><br><span class="line">	System.out.print(<span class="string">&quot;sb.substring(4)=&quot;</span> + sb.substring(<span class="number">4</span>));</span><br><span class="line">	<span class="comment">// substring方法截取字符串，可以指定截取的起始位置和终止位置</span></span><br><span class="line">	System.out.print(<span class="string">&quot;sb.substring(4,9)=&quot;</span> + sb.substring(<span class="number">4</span>, <span class="number">9</span>));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 获取字符串中某个位置的字符</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">testCharAtStr</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	StringBuffer sb = <span class="keyword">new</span> StringBuffer(<span class="string">&quot;This is a StringBuffer&quot;</span>);</span><br><span class="line">	System.out.println(sb.charAt(sb.length() - <span class="number">1</span>));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 添加各种类型的数据到字符串的尾部</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">testAppend</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	StringBuffer sb = <span class="keyword">new</span> StringBuffer(<span class="string">&quot;This is a StringBuffer!&quot;</span>);</span><br><span class="line">	sb.append(<span class="number">1.23f</span>);</span><br><span class="line">	System.out.println(sb.toString());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 删除字符串中的数据</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">testDelete</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	StringBuffer sb = <span class="keyword">new</span> StringBuffer(<span class="string">&quot;This is a StringBuffer!&quot;</span>);</span><br><span class="line">	sb.delete(<span class="number">0</span>, <span class="number">5</span>);</span><br><span class="line">	sb.deleteCharAt(sb.length() - <span class="number">1</span>);</span><br><span class="line">	System.out.println(sb.toString());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 向字符串中插入各种类型的数据</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">testInsert</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		StringBuffer sb = <span class="keyword">new</span> StringBuffer(<span class="string">&quot;This is a StringBuffer!&quot;</span>);</span><br><span class="line">		<span class="comment">// 能够在指定位置插入字符、字符数组、字符串以及各种数字和布尔值</span></span><br><span class="line">		sb.insert(<span class="number">2</span>, <span class="string">&#x27;W&#x27;</span>);</span><br><span class="line">		sb.insert(<span class="number">3</span>, <span class="keyword">new</span> <span class="keyword">char</span>[] &#123; <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span> &#125;);</span><br><span class="line">		sb.insert(<span class="number">8</span>, <span class="string">&quot;abc&quot;</span>);</span><br><span class="line">		sb.insert(<span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line">		sb.insert(<span class="number">3</span>, <span class="number">2.3f</span>);</span><br><span class="line">		sb.insert(<span class="number">6</span>, <span class="number">3.75d</span>);</span><br><span class="line">		sb.insert(<span class="number">5</span>, <span class="number">9843L</span>);</span><br><span class="line">		sb.insert(<span class="number">2</span>, <span class="keyword">true</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;testInsert: &quot;</span> + sb.toString());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 替换字符串中的某些字符</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">testReplace</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		StringBuffer sb = <span class="keyword">new</span> StringBuffer(<span class="string">&quot;This is a StringBuffer!&quot;</span>);</span><br><span class="line">		<span class="comment">// 将字符串中某段字符替换成另一个字符串</span></span><br><span class="line">		sb.replace(<span class="number">10</span>, sb.length(), <span class="string">&quot;Integer&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;testReplace: &quot;</span> + sb.toString());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 将字符串倒序</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">reverseStr</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		StringBuffer sb = <span class="keyword">new</span> StringBuffer(<span class="string">&quot;This is a StringBuffer!&quot;</span>);</span><br><span class="line">		System.out.println(sb.reverse()); <span class="comment">// reverse方法将字符串倒序</span></span><br><span class="line">	&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">       UsingStringBuffer.testAppend();</span><br><span class="line">       UsingStringBuffer.testCharAtStr();</span><br><span class="line">       UsingStringBuffer.testDelete();</span><br><span class="line">       UsingStringBuffer.testFindStr();</span><br><span class="line">       UsingStringBuffer.testInsert();</span><br><span class="line">       UsingStringBuffer.testReplace();</span><br><span class="line">       UsingStringBuffer.testSubStr();</span><br><span class="line">       UsingStringBuffer.reverseStr();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">This is a StringBuffer!1.23</span><br><span class="line">r</span><br><span class="line">is a StringBuffer</span><br><span class="line">sb.indexOf(&quot;is&quot;)=2</span><br><span class="line">sb.indexOf(&quot;is&quot;)=5</span><br><span class="line">sb.lastIndexOf(&quot;is&quot;) = 5</span><br><span class="line">sb.lastIndexOf(&quot;is&quot;, 1) = -1</span><br><span class="line">testInsert: Thtrue32.984333.75WABCisabc is a StringBuffer!</span><br><span class="line">testReplace: This is a Integer</span><br><span class="line">sb.substring(4)= is a StringBuffer</span><br><span class="line">sb.substring(4,9)= is a</span><br><span class="line">!reffuBgnirtS a si sihT</span><br></pre></td></tr></table></figure>

<p> StringBuffer类的replace方法同String类的replace方法不同,它的replace方法有三个参数,第一个参数指定被替换子串的起始位置，第二个参数指定被替换子串的终止位置，第三个参数指定新子串</p>
<p> 示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">public class Main</span><br><span class="line">&#123;</span><br><span class="line">  public static void main(String[] args)</span><br><span class="line">  &#123;</span><br><span class="line">    String a = &quot;a&quot;;</span><br><span class="line">    long start = System.currentTimeMillis();</span><br><span class="line">    String string = a;</span><br><span class="line">    for (int i = 0; i &lt; 100000; i++) &#123;</span><br><span class="line">         string += a;</span><br><span class="line">    &#125;</span><br><span class="line">    if (string.equals(&quot;abc&quot;)) &#123;&#125;</span><br><span class="line">    System.out.println(&quot;string+ cost time:&quot; + (System.currentTimeMillis() - start) + &quot;ms&quot;);</span><br><span class="line">    start = System.currentTimeMillis();</span><br><span class="line">    StringBuffer stringBuffer = new StringBuffer();</span><br><span class="line">    for (int i = 0; i &lt; 100000; i++) &#123;</span><br><span class="line">        stringBuffer.append(a);</span><br><span class="line">    &#125;</span><br><span class="line">    if (stringBuffer.toString().equals(&quot;abc&quot;)) &#123;&#125;</span><br><span class="line">    System.out.println(&quot;stringbuffer cost time:&quot; + (System.currentTimeMillis() - start) + &quot;ms&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ java  Main</span><br><span class="line">string+ cost time:4367ms</span><br><span class="line">stringbuffer cost time:3ms</span><br></pre></td></tr></table></figure>
<p>string+事实上是由stringbuilder完成的。我们来看一下这个程序的class文件内容就可以看出来了。</p>
<h4 id="不可变类"><a href="#不可变类" class="headerlink" title="不可变类"></a>不可变类</h4><p><strong>不可变类</strong>：所谓的不可变类是指这个类的实例一旦创建完成后，就不能改变其成员变量值。如JDK内部自带的很多不可变类：Interger、Long和String等。<br><strong>可变类</strong>：相对于不可变类，可变类创建实例后可以改变其成员变量值，开发中创建的大部分类都属于可变类。</p>
<p><strong>不可变类的优点</strong></p>
<p>说完可变类和不可变类的区别，我们需要进一步了解为什么要有不可变类？这样的特性对JAVA来说带来怎样的好处？</p>
<ol>
<li>线程安全<br>不可变对象是线程安全的，在线程之间可以相互共享，不需要利用特殊机制来保证同步问题，因为对象的值无法改变。可以降低并发错误的可能性，因为不需要用一些锁机制等保证内存一致性问题也减少了同步开销。</li>
<li>易于构造、使用和测试</li>
</ol>
<p><strong>不可变类的设计方法</strong></p>
<p>对于设计不可变类，个人总结出以下原则：</p>
<ol>
<li><p>类添加final修饰符，保证类不被继承。<br>如果类可以被继承会破坏类的不可变性机制，只要继承类覆盖父类的方法并且继承类可以改变成员变量值，那么一旦子类以父类的形式出现时，不能保证当前类是否可变。</p>
</li>
<li><p>保证所有成员变量必须私有，并且加上final修饰<br>通过这种方式保证成员变量不可改变。但只做到这一步还不够，因为如果是对象成员变量有可能再外部改变其值。所以第4点弥补这个不足。</p>
</li>
<li><p>不提供改变成员变量的方法，包括setter<br>避免通过其他接口改变成员变量的值，破坏不可变特性。</p>
</li>
<li><p>通过构造器初始化所有成员，进行深拷贝(deep copy)</p>
</li>
</ol>
<p>如果构造器传入的对象直接赋值给成员变量，还是可以通过对传入对象的修改进而导致改变内部变量的值。例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public final class ImmutableDemo &#123;  </span><br><span class="line">    private final int[] myArray;  </span><br><span class="line">    public ImmutableDemo(int[] array) &#123;  </span><br><span class="line">        this.myArray = array; // wrong  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这种方式不能保证不可变性，myArray和array指向同一块内存地址，用户可以在ImmutableDemo之外通过修改array对象的值来改变myArray内部的值。<br>为了保证内部的值不被修改，可以采用深度copy来创建一个新内存保存传入的值。正确做法：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public final class MyImmutableDemo &#123;  </span><br><span class="line">    private final int[] myArray;  </span><br><span class="line">    public MyImmutableDemo(int[] array) &#123;  </span><br><span class="line">        this.myArray = array.clone();   </span><br><span class="line">    &#125;   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="5">
<li><p>在getter方法中，不要直接返回对象本身，而是克隆对象，并返回对象的拷贝</p>
<p>这种做法也是防止对象外泄，防止通过getter获得内部可变成员对象后对成员变量直接操作，导致成员变量发生改变。</p>
</li>
</ol>
<p><strong>String对象的不可变性</strong></p>
<p>string对象在内存创建后就不可改变，不可变对象的创建一般满足以上5个原则，我们看看String代码是如何实现的。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">public final class String</span><br><span class="line">    implements java.io.Serializable, Comparable&lt;String&gt;, CharSequence</span><br><span class="line">&#123;</span><br><span class="line">    /** The value is used for character storage. */</span><br><span class="line">    private final char value[];</span><br><span class="line">    /** The offset is the first index of the storage that is used. */</span><br><span class="line">    private final int offset;</span><br><span class="line">    /** The count is the number of characters in the String. */</span><br><span class="line">    private final int count;</span><br><span class="line">    /** Cache the hash code for the string */</span><br><span class="line">    private int hash; // Default to 0</span><br><span class="line">    ....</span><br><span class="line">    public String(char value[]) &#123;</span><br><span class="line">         this.value = Arrays.copyOf(value, value.length); // deep copy操作</span><br><span class="line">     &#125;</span><br><span class="line">    ...</span><br><span class="line">     public char[] toCharArray() &#123;</span><br><span class="line">     // Cannot use Arrays.copyOf because of class initialization order issues</span><br><span class="line">        char result[] = new char[value.length];</span><br><span class="line">        System.arraycopy(value, 0, result, 0, value.length);</span><br><span class="line">        return result;</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如上代码所示，可以观察到以下设计细节:</p>
<ol>
<li>String类被final修饰，不可继承</li>
<li>string内部所有成员都设置为私有变量</li>
<li>不存在value的setter</li>
<li>并将value和offset设置为final。</li>
<li>当传入可变数组value[]时，进行copy而不是直接将value[]复制给内部变量.</li>
<li>获取value时不是直接返回对象引用，而是返回对象的copy.</li>
</ol>
<p>这都符合上面总结的不变类型的特性，也保证了String类型是不可变的类。</p>
<p><strong>String对象的不可变性的优缺点</strong></p>
<p>从上一节分析，String数据不可变类，那设置这样的特性有什么好处呢？我总结为以下几点：</p>
<ol>
<li><p>字符串常量池的需要.</p>
<p>字符串常量池可以将一些字符常量放在常量池中重复使用，避免每次都重新创建相同的对象、节省存储空间。但如果字符串是可变的，此时相同内容的String还指向常量池的同一个内存空间，当某个变量改变了该内存的值时，其他遍历的值也会发生改变。所以不符合常量池设计的初衷。</p>
</li>
<li><p>线程安全考虑。<br>同一个字符串实例可以被多个线程共享。这样便不用因为线程安全问题而使用同步。字符串自己便是线程安全的。</p>
</li>
<li><p>类加载器要用到字符串，不可变性提供了安全性，以便正确的类被加载。譬如你想加载java.sql.Connection类，而这个值被改成了myhacked.Connection，那么会对你的数据库造成不可知的破坏。</p>
</li>
<li><p>支持hash映射和缓存。<br>因为字符串是不可变的，所以在它创建的时候hashcode就被缓存了，不需要重新计算。这就使得字符串很适合作为Map中的键，字符串的处理速度要快过其它的键对象。这就是HashMap中的键往往都使用字符串。</p>
</li>
</ol>
<p>缺点：如果有对String对象值改变的需求，那么会创建大量的String对象。</p>
<p><strong>String对象的是否真的不可变</strong></p>
<p>虽然String对象将value设置为final,并且还通过各种机制保证其成员变量不可改变。但是还是可以通过反射机制的手段改变其值。例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">//创建字符串&quot;Hello World&quot;， 并赋给引用s</span><br><span class="line">String s = &quot;Hello World&quot;; </span><br><span class="line">System.out.println(&quot;s = &quot; + s); //Hello World</span><br><span class="line"></span><br><span class="line">//获取String类中的value字段</span><br><span class="line">Field valueFieldOfString = String.class.getDeclaredField(&quot;value&quot;);</span><br><span class="line">//改变value属性的访问权限</span><br><span class="line">valueFieldOfString.setAccessible(true);</span><br><span class="line"></span><br><span class="line">//获取s对象上的value属性的值</span><br><span class="line">char[] value = (char[]) valueFieldOfString.get(s);</span><br><span class="line">//改变value所引用的数组中的第5个字符</span><br><span class="line">value[5] = &#x27;_&#x27;;</span><br><span class="line">System.out.println(&quot;s = &quot; + s);  //Hello_World</span><br></pre></td></tr></table></figure>

<p>打印结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">s = Hello World</span><br><span class="line">s = Hello_World</span><br></pre></td></tr></table></figure>

<p>发现String的值已经发生了改变。也就是说，通过反射是可以修改所谓的“不可变”对象的</p>
<p><strong>总结</strong></p>
<p>不可变类是实例创建后就不可以改变成员遍历的值。这种特性使得不可变类提供了线程安全的特性但同时也带来了对象创建的开销，每更改一个属性都是重新创建一个新的对象。JDK内部也提供了很多不可变类如Integer、Double、String等。String的不可变特性主要为了满足常量池、线程安全、类加载的需求。合理使用不可变类可以带来极大的好处。</p>
<h3 id="参考："><a href="#参考：" class="headerlink" title="参考："></a>参考：</h3><ol>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/xiaoxi/p/6036701.html">https://www.cnblogs.com/xiaoxi/p/6036701.html</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_34490018/article/details/82110578">https://blog.csdn.net/qq_34490018/article/details/82110578</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/justcooooode/p/7603381.html">理解Java字符串常量池与intern()方法</a></li>
</ol>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">平心</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://pingxin0521.gitee.io/2019/04/04/Java-%E5%9F%BA%E7%A1%80-1-4-1/">https://pingxin0521.gitee.io/2019/04/04/Java-%E5%9F%BA%E7%A1%80-1-4-1/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://pingxin0521.gitee.io" target="_blank">平心de小屋</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Java/">Java</a></div><div class="post_share"><div class="social-share" data-image="https://i.loli.net/2020/05/08/okfOw28KlZFbE7z.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2019/04/04/Java-%E5%9F%BA%E7%A1%80-1-4-2/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://i.loli.net/2020/05/08/okfOw28KlZFbE7z.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Java 字符串(二)</div></div></a></div><div class="next-post pull-right"><a href="/2019/04/04/Java-%E5%9F%BA%E7%A1%80-1-5-2/"><img class="next-cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://i.loli.net/2020/05/08/okfOw28KlZFbE7z.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Java 面对对象特性和类加载顺序</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2019/07/12/Java-SpringBoot-1-4-2/" title="Spring boot 数据访问 MongoDB"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://i.loli.net/2020/05/08/okfOw28KlZFbE7z.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2020-01-25</div><div class="title">Spring boot 数据访问 MongoDB</div></div></a></div><div><a href="/2019/12/10/Java-SpringBoot-1-6-1/" title="Spring boot 消息队列(使用RabbitMQ)"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://i.loli.net/2020/05/08/7dHvepmfYOLWTrX.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2020-02-09</div><div class="title">Spring boot 消息队列(使用RabbitMQ)</div></div></a></div><div><a href="/2019/05/30/Java-SpringCloud-0-0/" title="Spring Cloud 入门 (一)"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://i.loli.net/2020/05/08/7dHvepmfYOLWTrX.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2020-12-27</div><div class="title">Spring Cloud 入门 (一)</div></div></a></div><div><a href="/2019/11/01/Java-SpringCloud-3-0/" title="Spring Cloud 组件之Hystrix (五)"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://i.loli.net/2020/05/08/vCnKyoFJZ1g4XYR.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2020-12-27</div><div class="title">Spring Cloud 组件之Hystrix (五)</div></div></a></div><div><a href="/2019/10/27/Java-SpringCloud-6-0/" title="微服务组件--分布式追踪系统"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://i.loli.net/2020/05/08/PFDRNxj93taz6pw.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2020-12-27</div><div class="title">微服务组件--分布式追踪系统</div></div></a></div><div><a href="/2019/11/03/Java-SpringCloud-6-2/" title="SpringCloud组件之Spring Cloud Sleuth (八)"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://i.loli.net/2020/05/08/gGE57HRvpcKPfDY.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2020-12-27</div><div class="title">SpringCloud组件之Spring Cloud Sleuth (八)</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://s2.ax1x.com/2020/02/11/1ovw6J.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">平心</div><div class="author-info__description">年轻人的life、learn and think</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">449</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">77</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">68</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/hanyunpeng0521"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/hanyunpeng0521" target="_blank" title="Github"><i class="fa fa-github"></i></a><a class="social-icon" href="mailto:m13839441583@163.com" target="_blank" title="Email"><i class="fa fa-envelope"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title=""><i class="fa fa-rss"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">为什么呢？开始提问吧</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-number">1.</span> <span class="toc-text">字符串</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#String%E7%B1%BB"><span class="toc-number">2.</span> <span class="toc-text">String类</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-number">2.1.</span> <span class="toc-text">常用方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-number">2.2.</span> <span class="toc-text">格式化字符串</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#StringBuilder"><span class="toc-number">2.3.</span> <span class="toc-text">StringBuilder</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#StringBuffer%E7%B1%BB"><span class="toc-number">2.4.</span> <span class="toc-text">StringBuffer类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8D%E5%8F%AF%E5%8F%98%E7%B1%BB"><span class="toc-number">2.5.</span> <span class="toc-text">不可变类</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E8%80%83%EF%BC%9A"><span class="toc-number">3.</span> <span class="toc-text">参考：</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/05/15/node-2-4/" title="Egg.js -- 为企业级框架和应用而生"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://i.loli.net/2020/05/08/okfOw28KlZFbE7z.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Egg.js -- 为企业级框架和应用而生"/></a><div class="content"><a class="title" href="/2021/05/15/node-2-4/" title="Egg.js -- 为企业级框架和应用而生">Egg.js -- 为企业级框架和应用而生</a><time datetime="2021-05-15T10:18:59.000Z" title="发表于 2021-05-15 18:18:59">2021-05-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/04/30/node-2-3/" title="Koa -- 基于Node.js平台的下一代Web开发框架"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://i.loli.net/2020/05/08/HjVAdIuT7bZJypS.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Koa -- 基于Node.js平台的下一代Web开发框架"/></a><div class="content"><a class="title" href="/2021/04/30/node-2-3/" title="Koa -- 基于Node.js平台的下一代Web开发框架">Koa -- 基于Node.js平台的下一代Web开发框架</a><time datetime="2021-04-30T10:18:59.000Z" title="发表于 2021-04-30 18:18:59">2021-04-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/04/01/node-2-1/" title="Node.JS web开发前置知识"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://i.loli.net/2020/05/08/gGE57HRvpcKPfDY.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Node.JS web开发前置知识"/></a><div class="content"><a class="title" href="/2021/04/01/node-2-1/" title="Node.JS web开发前置知识">Node.JS web开发前置知识</a><time datetime="2021-04-01T03:18:59.000Z" title="发表于 2021-04-01 11:18:59">2021-04-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/12/26/%E5%91%A8%E8%AE%B0-10-1/" title="第十一周--谷歌浏览器插件"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://i.loli.net/2020/05/08/gGE57HRvpcKPfDY.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="第十一周--谷歌浏览器插件"/></a><div class="content"><a class="title" href="/2020/12/26/%E5%91%A8%E8%AE%B0-10-1/" title="第十一周--谷歌浏览器插件">第十一周--谷歌浏览器插件</a><time datetime="2020-12-26T10:18:59.000Z" title="发表于 2020-12-26 18:18:59">2020-12-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/12/26/%E5%91%A8%E8%AE%B0-10-0/" title="第十一周--浏览器技术"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://i.loli.net/2020/05/08/vCnKyoFJZ1g4XYR.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="第十一周--浏览器技术"/></a><div class="content"><a class="title" href="/2020/12/26/%E5%91%A8%E8%AE%B0-10-0/" title="第十一周--浏览器技术">第十一周--浏览器技术</a><time datetime="2020-12-26T06:18:59.000Z" title="发表于 2020-12-26 14:18:59">2020-12-26</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2021 By 平心</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: '4lfIXzqxaC1ONs0MJO4oHu07-gzGzoHsz',
      appKey: 'qw99Bw8FD0KVKU9m457CwWsr',
      placeholder: 'Please leave your footprints',
      avatar: 'monsterid',
      meta: 'nick,mail,link'.split(','),
      pageSize: '10',
      lang: 'zh-CN',
      recordIP: true,
      serverURLs: '',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: true,
      path: window.location.pathname,
      requiredFields: ["nick,mail"],
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>