<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Android  菜单 | 平心de小屋</title><meta name="keywords" content="Android"><meta name="author" content="平心"><meta name="copyright" content="平心"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="前言Google在开发者网站上关于Menu的API指南中为开发者推荐了三种基本的菜单：选项菜单（OptionsMenu）、上下文菜单（ContextMenu）和弹出菜单（PopupMenu）。下面分别给出相应的基本实现步骤。">
<meta property="og:type" content="article">
<meta property="og:title" content="Android  菜单">
<meta property="og:url" content="https://pingxin0521.gitee.io/2019/04/30/Android-%E5%9F%BA%E7%A1%80-13/index.html">
<meta property="og:site_name" content="平心de小屋">
<meta property="og:description" content="前言Google在开发者网站上关于Menu的API指南中为开发者推荐了三种基本的菜单：选项菜单（OptionsMenu）、上下文菜单（ContextMenu）和弹出菜单（PopupMenu）。下面分别给出相应的基本实现步骤。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i.loli.net/2020/05/08/gGE57HRvpcKPfDY.jpg">
<meta property="article:published_time" content="2019-04-30T15:18:59.000Z">
<meta property="article:modified_time" content="2019-07-02T02:30:44.000Z">
<meta property="article:author" content="平心">
<meta property="article:tag" content="Android">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2020/05/08/gGE57HRvpcKPfDY.jpg"><link rel="shortcut icon" href="https://s2.ax1x.com/2020/02/11/1ovFOA.png"><link rel="canonical" href="https://pingxin0521.gitee.io/2019/04/30/Android-%E5%9F%BA%E7%A1%80-13/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: true,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Android  菜单',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2019-07-02 10:30:44'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    })(window)</script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://s2.ax1x.com/2020/02/11/1ovw6J.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">449</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">77</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">68</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://i.loli.net/2020/05/08/gGE57HRvpcKPfDY.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">平心de小屋</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Android  菜单</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2019-04-30T15:18:59.000Z" title="发表于 2019-04-30 23:18:59">2019-04-30</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2019-07-02T02:30:44.000Z" title="更新于 2019-07-02 10:30:44">2019-07-02</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Android/">Android</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Android/%E5%9F%BA%E7%A1%80/">基础</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">4.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>18分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Android  菜单"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>Google在开发者网站上关于<a target="_blank" rel="noopener" href="https://developer.android.google.cn/guide/topics/ui/menus.html">Menu的API指南</a>中为开发者推荐了三种基本的菜单：选项菜单（OptionsMenu）、上下文菜单（ContextMenu）和弹出菜单（PopupMenu）。下面分别给出相应的基本实现步骤。</p>
<span id="more"></span>

<p>从Android3.0（API level 11）开始，Android设备不再要求提供一个专门的菜单按钮，转而推荐使用ActionBar。所以现在市面上很多新设备使用三个虚拟按键，并不再额外提供菜单按钮。</p>
<p>因为Android版本的发展，对于菜单的支持各个版本有很大的区别，而Android3.0是个分水岭，大概可以分为下面三类：</p>
<ul>
<li>OptionMenu和ActionBar：一些操作的集合，如果开发的平台在Android3.0之上，推荐使用ActionBar，如果开发的平台在Android2.3或之下，还是可以使用OptionMenu的。</li>
<li>ContextMenu和ActionMode：ContextMenu是一个浮动的窗口形式展现一个选项列表，ActionMode是一个显示在屏幕顶部的操作栏，允许用户选择多个选项，ActionMode在Android3.0之后才有支持。</li>
<li>Popup Menu：PopupMenu是固定在View上的模态菜单，以弹出的方式显示，在Android3.0之后才有支持。</li>
</ul>
<h4 id="常用方法"><a href="#常用方法" class="headerlink" title="常用方法"></a>常用方法</h4><ul>
<li><p>onCreateOptionsMenu(Menu menu)<br>每次Activity一创建就会执行，一般只执行一次，创建并<strong>保留</strong>Menu的实例；</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">//获取MenuInflater</span><br><span class="line">    MenuInflater inflater = getMenuInflater();</span><br><span class="line">//加载Menu资源</span><br><span class="line">    inflater.inflate(R.menu.option_menu_normal,menu);</span><br><span class="line">    </span><br><span class="line">//此方法必须返回true，否则不予显示</span><br><span class="line">    return true；</span><br></pre></td></tr></table></figure></li>
<li><p>onPrepareOptionsMenu(Menu menu)<br> 每次menu被打开时，该方法就会执行一次，可用于对传入的旧Menu对象进行修改操作；</p>
</li>
<li><p>onOptionsItemSelected(MenuItem item)<br> 每次menu菜单项被点击时，该方法就会执行一次；</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">public boolean onOptionsItemSelected(MenuItem item) &#123;</span><br><span class="line">    switch (item.getItemId())&#123;</span><br><span class="line">        case R.id.option_normal_1:</span><br><span class="line">            return true; //返回true，将结束点击事件，不会进入下一级菜单</span><br><span class="line">        case R.id.option_normal_2:</span><br><span class="line">            return true;</span><br><span class="line">        case R.id.option_normal_3:</span><br><span class="line">            return true;</span><br><span class="line">        case R.id.option_normal_4:</span><br><span class="line">            return true;</span><br><span class="line">        default:</span><br><span class="line">            return super.onOptionsItemSelected(item); //不返回true，避免截断菜单项的点击事件</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>invalidateOptionsMenu()<br>刷新menu里的选项里内容，它会调用onCreateOptionsMenu(Menu menu)方法</p>
</li>
<li><p>onCreateContextMenu()<br>创建控件绑定的上下文菜单menu，根据方法里的View参数识别是哪个控件绑定</p>
</li>
<li><p>onContextItemSelected(MenuItem item)<br>点击控件绑定的上下菜单menu的内容项</p>
</li>
<li><p>invalidateOptionsMenu()<br>通知系统刷新Menu，之后，onPrepareOptionsMenu会被调用</p>
</li>
</ul>
<h4 id="使用XML定义Menu"><a href="#使用XML定义Menu" class="headerlink" title="使用XML定义Menu"></a>使用XML定义Menu</h4><p>理论上而言，使用XML和Java代码都可以创建Menu。但是在实际开发中，往往通过XML文件定义Menu，这样做有以下几个好处：</p>
<ul>
<li>使用XML可以获得更清晰的菜单结构</li>
<li>将菜单内容与应用的逻辑代码分离</li>
<li>可以使用应用资源框架，为不同的平台版本、屏幕尺寸创建最合适的菜单（如对drawable、string等系统资源的使用）</li>
</ul>
<h3 id="OptionsMenu"><a href="#OptionsMenu" class="headerlink" title="OptionsMenu"></a>OptionsMenu</h3><p>OptionsMenu在页面的标题栏的右侧创建一个菜单按钮，前提是菜单栏可以显示的时候才有，否则会被隐藏。点击按钮弹出OptionsMenu菜单。</p>
<ol>
<li><p>创建选项菜单：重写Activity的onCreateOptionMenu（Menu menu）方法。</p>
<ul>
<li><p>设置菜单项可用代码动态设置menu.add();</p>
</li>
<li><p>还可以通过xml设置MenuInflater.inflate();</p>
</li>
</ul>
</li>
<li><p>设置菜单点击事件：onOptionsItemSelected();</p>
</li>
<li><p>菜单关闭后发生的动作：onOptionMenuClosed(Menu menu);</p>
</li>
<li><p>选项菜单显示之前会调用，可以在这里根据需要调整菜单：onPrepareOptionsMenu(Menu menu);</p>
</li>
<li><p>打开后发生的动作： onMenuOpened(int featureId,Menu menu);</p>
</li>
</ol>
<h4 id="方法一："><a href="#方法一：" class="headerlink" title="方法一："></a>方法一：</h4><p>通过xml设置菜单（res/menu/menu.xml）</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">menu</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span>  </span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span>  </span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">&quot;com.example.menudemo.MenuActivity&quot;</span> &gt;</span>  </span><br><span class="line">   <span class="tag">&lt;<span class="name">group</span> <span class="attr">android:id</span>=<span class="string">&quot;@+id/group1&quot;</span>&gt;</span>  </span><br><span class="line">     <span class="tag">&lt;<span class="name">item</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/action_menu1&quot;</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:orderInCategory</span>=<span class="string">&quot;300&quot;</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:menuCategory</span>=<span class="string">&quot;container&quot;</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:showAsAction</span>=<span class="string">&quot;never&quot;</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:title</span>=<span class="string">&quot;menu1&quot;</span>/&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/action_menu2&quot;</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:orderInCategory</span>=<span class="string">&quot;200&quot;</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:menuCategory</span>=<span class="string">&quot;system&quot;</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:showAsAction</span>=<span class="string">&quot;never&quot;</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:title</span>=<span class="string">&quot;menu2&quot;</span>/&gt;</span>  </span><br><span class="line">   <span class="tag">&lt;/<span class="name">group</span>&gt;</span>  </span><br><span class="line">   <span class="tag">&lt;<span class="name">group</span> <span class="attr">android:id</span>=<span class="string">&quot;@+id/group2&quot;</span>&gt;</span>  </span><br><span class="line">       <span class="tag">&lt;<span class="name">item</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/action_menu3&quot;</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:orderInCategory</span>=<span class="string">&quot;100&quot;</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:menuCategory</span>=<span class="string">&quot;secondary&quot;</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:showAsAction</span>=<span class="string">&quot;never&quot;</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:title</span>=<span class="string">&quot;menu3&quot;</span>/&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/action_menu4&quot;</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:orderInCategory</span>=<span class="string">&quot;400&quot;</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:menuCategory</span>=<span class="string">&quot;alternative&quot;</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:showAsAction</span>=<span class="string">&quot;never&quot;</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:title</span>=<span class="string">&quot;menu4&quot;</span>/&gt;</span>  </span><br><span class="line">   <span class="tag">&lt;/<span class="name">group</span>&gt;</span>    </span><br><span class="line"><span class="tag">&lt;/<span class="name">menu</span>&gt;</span>  </span><br></pre></td></tr></table></figure>

<p> <strong>&lt;item&gt;标签的属性含义解释：</strong></p>
<table>
<thead>
<tr>
<th>属性名</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>menuCategory</td>
<td>设置菜单项的种类。有四个可选值：<a target="_blank" rel="noopener" href="http://lib.csdn.net/base/docker">Container</a>、system、secondary、alternative。通过menuCategory属性可以控制菜单项的位置。</td>
</tr>
<tr>
<td>orderInCategory</td>
<td>同类菜单的排列顺序，为整数值，值越大显示越靠前。</td>
</tr>
<tr>
<td>titleCondensed</td>
<td>菜单项的短标题。当菜单文字太长时显示这个</td>
</tr>
<tr>
<td>alphabeticShortcut</td>
<td>菜单项的字母快捷键。</td>
</tr>
<tr>
<td>showAsAction</td>
<td><strong>Never</strong>：总是显示在移除菜单中。  <strong>Always</strong>：显示在ActionBar上。  <strong>ifRoom</strong>：如果actionBar空间足够就显示在ActionBar上。  <strong>withText</strong>：默认格式如果是含有文字和图表的话，只显示图标，使用ifRoom|withText可以显示图标和文字。 android:showAsAction属性也可包含“collapseActionView”属性值，这个值是可选的，并且声明了这个操作视窗应该被折叠到一个按钮中，当用户选择这个按钮时，这个操作视窗展开。否则，这个操作视窗在默认的情况下是可见的，并且即便在用于不适用的时候，也要占据操作栏的有效空间。  参考链接：<a href="http://blog.csdn[.NET](http://lib.csdn.net/base/dotnet)/think_soft/article/details/7370686">http://blog.csdn[.NET](http://lib.csdn.net/base/dotnet)/think_soft/article/details/7370686</a></td>
</tr>
</tbody></table>
<p><strong>&lt;group&gt;标签</strong>的作用是可以进行整组操作，把一些具有相同操作的菜单放到一个组内。</p>
<p>Fragment的onCreate()方法中调用 setHasOptionsMenu(true) 方法使之显示出来。</p>
<p>在Activity里加载菜单</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span>  </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onCreateOptionsMenu</span><span class="params">(Menu menu)</span> </span>&#123;  </span><br><span class="line"><span class="comment">// Inflate the menu; this adds items to the action bar if it is present.  </span></span><br><span class="line">getMenuInflater().inflate(R.menu.menu, menu);  </span><br><span class="line"><span class="keyword">return</span> <span class="keyword">true</span>;  </span><br><span class="line">&#125;       </span><br></pre></td></tr></table></figure>

<h4 id="方法二："><a href="#方法二：" class="headerlink" title="方法二："></a>方法二：</h4><p>通过代码添加menu</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span>  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onCreateOptionsMenu</span><span class="params">(Menu menu)</span> </span>&#123;  </span><br><span class="line">        </span><br><span class="line">        <span class="comment">/* </span></span><br><span class="line"><span class="comment">         * add()方法的四个参数，依次是： </span></span><br><span class="line"><span class="comment">         * 1、组别，如果不分组的话就写Menu.NONE, </span></span><br><span class="line"><span class="comment">         * 2、Id，这个很重要，Android根据这个Id来确定不同的菜单 </span></span><br><span class="line"><span class="comment">         * 3、顺序，那个菜单现在在前面由这个参数的大小决定，参数越小，显示的越前 </span></span><br><span class="line"><span class="comment">         * 4、文本，菜单的显示文本 </span></span><br><span class="line"><span class="comment">         */</span>  </span><br><span class="line">        menu.add(Menu.NONE, Menu.FIRST + <span class="number">1</span>, <span class="number">5</span>, <span class="string">&quot;删除&quot;</span>).setIcon(  </span><br><span class="line">        android.R.drawable.ic_menu_delete);  </span><br><span class="line">        <span class="comment">// setIcon()方法设置菜单图标  </span></span><br><span class="line">        menu.add(Menu.NONE, Menu.FIRST + <span class="number">2</span>, <span class="number">2</span>, <span class="string">&quot;保存&quot;</span>).setIcon(  </span><br><span class="line">        android.R.drawable.ic_menu_save);  </span><br><span class="line">        menu.add(Menu.NONE, Menu.FIRST + <span class="number">3</span>, <span class="number">6</span>, <span class="string">&quot;帮助&quot;</span>).setIcon(  </span><br><span class="line">        android.R.drawable.ic_menu_help);  </span><br><span class="line">        menu.add(Menu.NONE, Menu.FIRST + <span class="number">4</span>, <span class="number">1</span>, <span class="string">&quot;添加&quot;</span>).setIcon(  </span><br><span class="line">        android.R.drawable.ic_menu_add);  </span><br><span class="line">        menu.add(Menu.NONE, Menu.FIRST + <span class="number">5</span>, <span class="number">4</span>, <span class="string">&quot;详细&quot;</span>).setIcon(  </span><br><span class="line">        android.R.drawable.ic_menu_info_details);  </span><br><span class="line">        menu.add(Menu.NONE, Menu.FIRST + <span class="number">6</span>, <span class="number">3</span>, <span class="string">&quot;发送&quot;</span>).setIcon(  </span><br><span class="line">        android.R.drawable.ic_menu_send);  </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 通过反射，设置menu显示icon</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> view</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> menu</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@SuppressLint(&quot;RestrictedApi&quot;)</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">boolean</span> <span class="title">onPrepareOptionsPanel</span><span class="params">(View view, Menu menu)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (menu != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (menu.getClass() == MenuBuilder.class) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="meta">@SuppressLint(&quot;PrivateApi&quot;)</span></span><br><span class="line">                Method m = menu.getClass().</span><br><span class="line">                        getDeclaredMethod(<span class="string">&quot;setOptionalIconsVisible&quot;</span>,</span><br><span class="line">                                Boolean.TYPE);</span><br><span class="line">                m.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">                m.invoke(menu, <span class="keyword">true</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">super</span>.onPrepareOptionsPanel(view, menu);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://i.loli.net/2019/05/14/5cda152a8a9d355073.png" alt="1.png"></p>
<p><strong>选项菜单设置点击监听</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Override</span>  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onOptionsItemSelected</span><span class="params">(MenuItem item)</span> </span>&#123;  </span><br><span class="line">        Log.i(TAG, <span class="string">&quot;onOptionsItemSelected&quot;</span>);  </span><br><span class="line">        <span class="keyword">int</span> id = item.getItemId();  </span><br><span class="line">        <span class="keyword">switch</span> (id) &#123;  </span><br><span class="line">        <span class="keyword">case</span> Menu.FIRST+<span class="number">1</span>:  </span><br><span class="line">            Toast.makeText(MenuActivity.<span class="keyword">this</span>, <span class="string">&quot;点击了删除按钮&quot;</span>, Toast.LENGTH_SHORT).show();  </span><br><span class="line">            <span class="keyword">break</span>;  </span><br><span class="line">        <span class="keyword">default</span>:  </span><br><span class="line">            <span class="keyword">break</span>;  </span><br><span class="line">        &#125;  </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.onOptionsItemSelected(item);  </span><br><span class="line">    &#125;  </span><br></pre></td></tr></table></figure>



<h3 id="ContextMenu"><a href="#ContextMenu" class="headerlink" title="ContextMenu"></a>ContextMenu</h3><p>当用户长时间按键不放时，弹出来的菜单称为上下文菜单。Windows中用鼠标右键弹出的菜单就是上下文菜单。</p>
<p>上下文菜单是用户长按某一元素时出现的浮动菜单。它提供的操作将影响所选内容，主要应用于列表中的每一项元素（如长按列表项弹出删除对话框）。上下文操作模式将在屏幕顶部栏（菜单栏）显示影响所选内容的操作选项，并允许用户选择多项，一般用于对列表类型的数据进行批量操作。</p>
<p>要提供浮动上下文菜单，可以参照以下步骤：</p>
<ul>
<li>在Activity或Fragment中调用 registerForContextMenu(View v) 方法，注册需要和上下文菜单关联的View。如果将ListView或GridView作为参数传入，那么每个列表项将会有相同的浮动上下文菜单。</li>
<li>在Activity或Fragment中重写onCreateContextMenu方法，加载Menu资源。</li>
<li>在Activity或Fragment中重写onContextItemSelected方法，实现菜单项的点击逻辑。</li>
</ul>
<p> 创建上下文菜单的步骤：</p>
<ol>
<li><p>调用registerForContextMenu（）方法，为视图注册上下文菜单。如<code>textView tv</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">   </span><br><span class="line">@Override  </span><br><span class="line">    protected void onCreate(Bundle savedInstanceState) &#123;  </span><br><span class="line">        super.onCreate(savedInstanceState);  </span><br><span class="line">        setContentView(R.layout.activity_menu);  </span><br><span class="line">        tv = (TextView)findViewById(R.id.tv);  </span><br><span class="line">        registerForContextMenu(tv);  </span><br><span class="line">    &#125;  </span><br></pre></td></tr></table></figure></li>
<li><p>覆盖Activity的onCreateContextMenu（）方法，调用Menu的add方法添加菜单项（MenuItem）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">   </span><br><span class="line">@Override  </span><br><span class="line">    public void onCreateContextMenu(ContextMenu menu, View v,  </span><br><span class="line">            ContextMenuInfo menuInfo) &#123;  </span><br><span class="line">        setIconVisible(menu);  </span><br><span class="line">        // TODO Auto-generated method stub  </span><br><span class="line">         menu.add(Menu.NONE, Menu.FIRST + 1, 5, &quot;删除&quot;).setIcon(  </span><br><span class="line">                    android.R.drawable.ic_menu_delete);  </span><br><span class="line">        // setIcon()方法设置菜单图标  </span><br><span class="line">        menu.add(Menu.NONE, Menu.FIRST + 2, 2, &quot;保存&quot;).setIcon(  </span><br><span class="line">                    android.R.drawable.ic_menu_save);  </span><br><span class="line">        menu.add(Menu.NONE, Menu.FIRST + 3, 6, &quot;帮助&quot;).setIcon(  </span><br><span class="line">                    android.R.drawable.ic_menu_help);  </span><br><span class="line">        menu.add(Menu.NONE, Menu.FIRST + 4, 1, &quot;添加&quot;).setIcon(  </span><br><span class="line">                    android.R.drawable.ic_menu_add);  </span><br><span class="line">        menu.add(Menu.NONE, Menu.FIRST + 5, 4, &quot;详细&quot;).setIcon(  </span><br><span class="line">                    android.R.drawable.ic_menu_info_details);  </span><br><span class="line">        menu.add(Menu.NONE, Menu.FIRST + 6, 3, &quot;发送&quot;).setIcon(  </span><br><span class="line">                    android.R.drawable.ic_menu_send);  </span><br><span class="line">        super.onCreateContextMenu(menu, v, menuInfo);  </span><br><span class="line">    &#125;  </span><br></pre></td></tr></table></figure></li>
<li><p>覆盖onContextItemSelected（）方法，响应菜单单击事件。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">   </span><br><span class="line">@Override  </span><br><span class="line">    public boolean onContextItemSelected(MenuItem item) &#123;  </span><br><span class="line">        // TODO Auto-generated method stub  </span><br><span class="line">        int id = item.getItemId();  </span><br><span class="line">        switch (id) &#123;  </span><br><span class="line">        case Menu.FIRST+1:  </span><br><span class="line">            Toast.makeText(MenuActivity.this, &quot;点击了删除按钮&quot;, Toast.LENGTH_SHORT).show();  </span><br><span class="line">            break;  </span><br><span class="line">        default:  </span><br><span class="line">            break;  </span><br><span class="line">        &#125;  </span><br><span class="line">        return super.onContextItemSelected(item);  </span><br><span class="line">    &#125;  </span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://i.loli.net/2019/05/14/5cda163bda93484721.png" alt="1.png"></p>
</li>
</ol>
<h4 id="创建子菜单步骤："><a href="#创建子菜单步骤：" class="headerlink" title="创建子菜单步骤："></a>创建子菜单步骤：</h4><ol>
<li><p>覆盖Activity的onCreateOptionsMenu（）方法，调用Menu的addSubMenu（）方法；添加子菜单项（subMenu）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">   </span><br><span class="line">@Override  </span><br><span class="line">    public boolean onCreateOptionsMenu(Menu menu) &#123;  </span><br><span class="line">        //调用这个方法设置图标的可见性  </span><br><span class="line">        setIconVisible(menu);  </span><br><span class="line">        /* </span><br><span class="line">         * add()方法的四个参数，依次是： </span><br><span class="line">         * 1、组别，如果不分组的话就写Menu.NONE, </span><br><span class="line">         * 2、Id，这个很重要，Android根据这个Id来确定不同的菜单 </span><br><span class="line">         * 3、顺序，那个菜单现在在前面由这个参数的大小决定，参数越小，显示的越前 </span><br><span class="line">         * 4、文本，菜单的显示文本 </span><br><span class="line">         */  </span><br><span class="line">         </span><br><span class="line">      //添加子菜单    </span><br><span class="line">        SubMenu subMenu = menu.addSubMenu(0,2,Menu.NONE, &quot;难度星级-&gt;&quot;).setIcon(android.R.drawable.ic_menu_directions);    </span><br><span class="line">          //添加子菜单项    </span><br><span class="line">          subMenu.add(2, 100, 1, &quot;☆☆☆☆☆&quot;);    </span><br><span class="line">          subMenu.add(2, 101, 2, &quot;☆☆☆&quot;);    </span><br><span class="line">          subMenu.add(2, 102, 3, &quot;☆&quot;);  </span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure></li>
<li><p>覆盖onOptionsItemSelected()方法响应点击事件。上下文菜单处理方式和此一致。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">   </span><br><span class="line">   </span><br><span class="line">@Override  </span><br><span class="line">    public boolean onOptionsItemSelected(MenuItem item) &#123;  </span><br><span class="line">        Log.i(TAG, &quot;onOptionsItemSelected&quot;);  </span><br><span class="line">        int id = item.getItemId();  </span><br><span class="line">        switch (id) &#123;  </span><br><span class="line">        case 100:  </span><br><span class="line">            Toast.makeText(MenuActivity.this, &quot;点击了五颗星&quot;, Toast.LENGTH_SHORT).show();  </span><br><span class="line">            break;  </span><br><span class="line">        default:  </span><br><span class="line">            break;  </span><br><span class="line">        &#125;  </span><br><span class="line">        return super.onOptionsItemSelected(item);  </span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h4><p>ContextMenu针对在Activity的View中的所有控件，在长按View控件达到2秒钟弹出一个菜单项。</p>
<p>效果图：</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://i.loli.net/2019/05/11/5cd6c3efec080.png" alt="1.png"></p>
<p>实现方式：</p>
<ol>
<li><p>在Activity的OnCreate()方法中对Button按钮或者整个活动页面添加菜单响应监听：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//长按弹出上下文菜单的Button</span><br><span class="line">Button contextMenu = (Button) findViewById(R.id.contextMenu);</span><br><span class="line">//长按页面弹出上下文菜单</span><br><span class="line">View view = findViewById(R.id.theLayout);</span><br><span class="line">contextMenu.setOnCreateContextMenuListener(this);//为Button单独实现ContextMenu</span><br><span class="line">this.registerForContextMenu(view);//长按页面空白地方会弹出Menu</span><br></pre></td></tr></table></figure>

<p>因为Activity已经实现了OnCreateContextMenuListener，所以要在Activity中重写该类的一些方法：</p>
</li>
<li><p>创建菜单</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"> //方法2，因为activity已经实现了OnCreateContextMenuListener，所以只需要重写onCreateContextMenu()方法</span><br><span class="line"> @Override</span><br><span class="line"> public void onCreateContextMenu(ContextMenu menu, View v, ContextMenu.ContextMenuInfo menuInfo) &#123;//这里是ContextMenu参数</span><br><span class="line">     setContextMenuIconEnable(menu, true);//设置菜单的Icon图标可见，这个方法后面详解,针对Android高版本的菜单图标显示的方法</span><br><span class="line">     menu.add(1, 2, 1, &quot;添加&quot;).setIcon(android.R.drawable.ic_menu_add);</span><br><span class="line">     menu.add(1, 3, 2, &quot;删除&quot;).setIcon(android.R.drawable.ic_menu_delete);</span><br><span class="line">     SubMenu m = menu.addSubMenu(0, 4, 3, &quot;子菜单&quot;).setIcon(android.R.drawable.ic_media_next);</span><br><span class="line">     m.add(0, 41, 0, &quot;子菜单项1&quot;);</span><br><span class="line">     m.add(0, 42, 0, &quot;子菜单项2&quot;);</span><br><span class="line">     m.add(0, 43, 0, &quot;子菜单项3&quot;);</span><br><span class="line">     super.onCreateContextMenu(menu, v, menuInfo);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>菜单关闭</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">public void onContextMenuClosed(Menu menu) &#123;</span><br><span class="line">    Toast.makeText(this,&quot;关闭&quot;,Toast.LENGTH_SHORT).show();</span><br><span class="line">    super.onContextMenuClosed(menu);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>菜单被点击</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">   public boolean onContextItemSelected(MenuItem item) &#123;</span><br><span class="line">       switch (item.getItemId()) &#123;</span><br><span class="line">           case 2:</span><br><span class="line">               Toast.makeText(this, &quot;添加&quot;, Toast.LENGTH_SHORT).show();</span><br><span class="line">               break;</span><br><span class="line">           case 3:</span><br><span class="line">               Toast.makeText(this, &quot;删除&quot;, Toast.LENGTH_LONG).show();</span><br><span class="line">               break;</span><br><span class="line">           default:</span><br><span class="line">               break;</span><br><span class="line">       &#125;</span><br><span class="line">       return super.onContextItemSelected(item);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="PopupMenu"><a href="#PopupMenu" class="headerlink" title="PopupMenu"></a>PopupMenu</h3><p>弹出菜单以垂直列表形式显示一系列操作选项，一般由某一控件触发，弹出菜单将显示在对应控件的上方或下方。它适用于提供与特定内容相关的大量操作</p>
<p>可以将弹出菜单的使用拆分为以下四个步骤：</p>
<ul>
<li>实例化PopupMenu，它的构造方法需要两个参数，分别为Context以及PopupMenu依赖的View对象。</li>
<li>使用MenuInflater将Menu资源加载到PopupMenu.getMenu()返回的Menu对象中。</li>
<li>调用setOnMenuItemClickListener方法为PopupMenu设置点击监听器。</li>
<li>调用==PopupMenu.show()==将弹出菜单显示出来。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">//XML文件代码</span><br><span class="line"></span><br><span class="line">&lt;menu xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;</span><br><span class="line">    &lt;item android:id=&quot;@+id/popup_add&quot;</span><br><span class="line">        android:title=&quot;添加&quot;/&gt;</span><br><span class="line">    &lt;item android:id=&quot;@+id/popup_delete&quot;</span><br><span class="line">        android:title=&quot;删除&quot;/&gt;</span><br><span class="line">    &lt;item android:id=&quot;@+id/popup_more&quot;</span><br><span class="line">        android:title=&quot;更多&quot;/&gt;</span><br><span class="line">&lt;/menu&gt;</span><br><span class="line"></span><br><span class="line">//Java文件代码</span><br><span class="line"></span><br><span class="line">@Override</span><br><span class="line">protected void onCreate(Bundle savedInstanceState) &#123;</span><br><span class="line">    super.onCreate(savedInstanceState);</span><br><span class="line">    setContentView(R.layout.activity_popup_menu);</span><br><span class="line"></span><br><span class="line">    findViewById(R.id.popup_menu_view).setOnClickListener(new View.OnClickListener() &#123;</span><br><span class="line">        @Override</span><br><span class="line">        public void onClick(View view) &#123;</span><br><span class="line">            PopupMenu popupMenu=new PopupMenu(PopupMenuActivity.this,view);//1.实例化PopupMenu</span><br><span class="line">            getMenuInflater().inflate(R.menu.popup_menu,popupMenu.getMenu());//2.加载Menu资源</span><br><span class="line"></span><br><span class="line">            //3.为弹出菜单设置点击监听</span><br><span class="line">            popupMenu.setOnMenuItemClickListener(new PopupMenu.OnMenuItemClickListener() &#123;</span><br><span class="line">                @Override</span><br><span class="line">                public boolean onMenuItemClick(MenuItem item) &#123;</span><br><span class="line">                    switch (item.getItemId())&#123;</span><br><span class="line">                        case R.id.popup_add:</span><br><span class="line">                            Toast.makeText(PopupMenuActivity.this,&quot;添加&quot;,Toast.LENGTH_SHORT).show();</span><br><span class="line">                            return true;</span><br><span class="line">                        case R.id.popup_delete:</span><br><span class="line">                            Toast.makeText(PopupMenuActivity.this,&quot;删除&quot;,Toast.LENGTH_SHORT).show();</span><br><span class="line">                            return true;</span><br><span class="line">                        case R.id.popup_more:</span><br><span class="line">                            Toast.makeText(PopupMenuActivity.this,&quot;更多&quot;,Toast.LENGTH_SHORT).show();</span><br><span class="line">                            return true;</span><br><span class="line">                        default:</span><br><span class="line">                            return false;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            popupMenu.show();//4.显示弹出菜单</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="示例-1"><a href="#示例-1" class="headerlink" title="示例"></a>示例</h4><p>效果图：</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://i.loli.net/2019/05/11/5cd6c3f00b537.png" alt="3.png"></p>
<p>实现方式：</p>
<ol>
<li>为控件添加属性如下:</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">android:onClick=&quot;popUpMenu&quot;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li><p>在Activity中添加对应函数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">public void popUpMenu(View view) &#123;</span><br><span class="line">    /**</span><br><span class="line">     * 第一个参数上下文对象</span><br><span class="line">     * 第二个参数为锚点，何谓锚点？就是你这个弹出式菜单以哪个view为标准弹出，</span><br><span class="line">     * 如果在这个view的下面有空间就在这个view下面的空间弹出，如果没有空间就</span><br><span class="line">     * 在此view的上面弹出</span><br><span class="line">     */</span><br><span class="line">    PopupMenu popupMenu = new PopupMenu(this, view);</span><br><span class="line">    setOptionsAndPopupMenuIconEnable(popupMenu.getMenu(), true);//显示Menu的图标方法，稍后详解</span><br><span class="line">    /**</span><br><span class="line">     * 第一个参数为菜单布局文件</span><br><span class="line">     * 第二个参数为Menu对象，通过getMenu()获得。</span><br><span class="line">     */</span><br><span class="line">    getMenuInflater().inflate(R.menu.menu, popupMenu.getMenu());</span><br><span class="line">    /**</span><br><span class="line">     * 要想显示必须调用.show()方法</span><br><span class="line">     */</span><br><span class="line">    //弹出菜单的点击事件也没有回调事件，需要自己设置监听事件onMenuItemCilckListener()，</span><br><span class="line">    //并在其中实现逻辑，代码如下：</span><br><span class="line">    //值得注意的是最后的返回值，这个涉及到view的事件分发。简单的意思就是，返回true代码消耗这次点击事件，</span><br><span class="line">    //事件不会继续传播，如果返回false则事件会继续传播的。</span><br><span class="line">    //比如这个弹出菜单的又设置了setOnDismissListener这个事件，</span><br><span class="line">    //那么如果返回true，则这个事件不起作用，返回false则点击事件处理完后，这个事件还会起作用。</span><br><span class="line">    //但是亲测true好像没有用</span><br><span class="line">    popupMenu.setOnMenuItemClickListener(new PopupMenu.OnMenuItemClickListener() &#123;</span><br><span class="line">        @Override</span><br><span class="line">        public boolean onMenuItemClick(MenuItem menuItem) &#123;</span><br><span class="line">            Toast.makeText(MainActivity.this, menuItem.getTitle().toString(), Toast.LENGTH_SHORT).show();</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    popupMenu.setOnDismissListener(new PopupMenu.OnDismissListener() &#123;</span><br><span class="line">        @Override</span><br><span class="line">        public void onDismiss(PopupMenu popupMenu) &#123;</span><br><span class="line">            Toast.makeText(MainActivity.this, &quot;PopupMenu的Dismiss&quot;, Toast.LENGTH_SHORT).show();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    popupMenu.setGravity(Gravity.BOTTOM);//没有用</span><br><span class="line">    popupMenu.show();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<p>上面可以看出关于PopupMenu菜单的所有的实现以及点击按钮事件都在这个方法内完成。</p>
<h3 id="关于菜单的创建说明"><a href="#关于菜单的创建说明" class="headerlink" title="关于菜单的创建说明"></a>关于菜单的创建说明</h3><ol>
<li><p>add方法的参数解析</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//        add()方法的四个参数，依次是：</span><br><span class="line">//        1、组别，如果不分组的话就写Menu.NONE,</span><br><span class="line">//        2、Id，这个很重要，Android根据这个Id来确定不同的菜单</span><br><span class="line">//        3、顺序，哪个菜单项在前面由这个参数的大小决定</span><br><span class="line">//        4、文本，菜单项的显示文本</span><br><span class="line">        menu.add(0, 5, 1, &quot;添加1&quot;).setIcon(android.R.drawable.ic_menu_add);</span><br></pre></td></tr></table></figure></li>
<li><p>通过布局文件创建菜单</p>
<p>新建布局文件，在res资源目录下新建一个menu资源文件夹，选择类型就是menu。然后在menu文件下面新建一个menu.xml文件，这个名字可以自己取。下面包含了二级菜单的创建。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;menu xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;</span><br><span class="line">    &lt;item</span><br><span class="line">        android:id=&quot;@+id/add_item&quot;</span><br><span class="line">        android:icon=&quot;@android:drawable/ic_menu_add&quot;</span><br><span class="line">        android:title=&quot;Add&quot; /&gt;</span><br><span class="line">    &lt;item</span><br><span class="line">        android:id=&quot;@+id/remove_item&quot;</span><br><span class="line">        android:icon=&quot;@android:drawable/ic_popup_reminder&quot;</span><br><span class="line">        android:title=&quot;Remove&quot; /&gt;</span><br><span class="line">    &lt;item</span><br><span class="line">        android:id=&quot;@+id/item_china&quot;</span><br><span class="line">        android:orderInCategory=&quot;100&quot;</span><br><span class="line">        android:title=&quot;中国&quot;&gt;</span><br><span class="line">        &lt;menu&gt;</span><br><span class="line">            &lt;item</span><br><span class="line">                android:id=&quot;@+id/item_beijing&quot;</span><br><span class="line">                android:orderInCategory=&quot;200&quot;</span><br><span class="line">                android:title=&quot;北京&quot;/&gt;</span><br><span class="line">            &lt;item</span><br><span class="line">                android:id=&quot;@+id/item_shanghai&quot;</span><br><span class="line">                android:orderInCategory=&quot;200&quot;</span><br><span class="line">                android:title=&quot;上海&quot;/&gt;</span><br><span class="line">        &lt;/menu&gt;</span><br><span class="line">    &lt;/item&gt;</span><br><span class="line">&lt;/menu&gt;</span><br></pre></td></tr></table></figure>

<p>通过资源文件新建菜单</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">getMenuInflater().inflate(R.menu.menu, Menu);</span><br></pre></td></tr></table></figure>

<p>通过该方法直接将meun.xml的菜单解析到Menu实例中。</p>
</li>
</ol>
<h4 id="关于菜单图片的显示问题"><a href="#关于菜单图片的显示问题" class="headerlink" title="关于菜单图片的显示问题"></a>关于菜单图片的显示问题</h4><p>Android的4.0之前，设置图标是默认显示的，但是4.0之后，就不在默认了。现在针对三种菜单Menu的图标显示方法如下</p>
<ol>
<li><p>针对ContextMenu菜单</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">// 经过试验ContextMenu有效，对OptionMenu无效</span><br><span class="line">private void setContextMenuIconEnable(Menu menu, boolean enable) &#123;</span><br><span class="line">    if (menu != null) &#123;</span><br><span class="line">        //com.android.internal.view.menu.ContextMenuBuilder，这是菜单menu的实体类</span><br><span class="line">        Log.d(&quot;AAA&quot;, menu.getClass().getName().toString());</span><br><span class="line">        try &#123;</span><br><span class="line">            //这是ContextMenu加载菜单的Builder，com.android.internal.view.menu.MenuBuilder</span><br><span class="line">            Class&lt;?&gt; clazz = Class.forName(&quot;com.android.internal.view.menu.MenuBuilder&quot;);</span><br><span class="line">            Method m = clazz.getDeclaredMethod(&quot;setOptionalIconsVisible&quot;, Boolean.TYPE);</span><br><span class="line">            Log.d(&quot;aaa&quot;, m.toString());</span><br><span class="line">            m.setAccessible(true);</span><br><span class="line">            //MenuBuilder实现Menu接口，创建菜单时，传进来的menu其实就是MenuBuilder对象(java的多态特征)</span><br><span class="line">            m.invoke(menu, enable);</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>针对PopupMenu和OptionsMenu菜单</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">//这是针对OptionsMenu和PopupMenu菜单的设置Icon图标可见的方法</span><br><span class="line"> private void setOptionsAndPopupMenuIconEnable(Menu menu, boolean enable) &#123;</span><br><span class="line">     if (menu != null) &#123;</span><br><span class="line">         Log.d(&quot;BBB&quot;, menu.getClass().getName().toString());</span><br><span class="line">         if (menu.getClass().getSimpleName().equals(&quot;MenuBuilder&quot;)) &#123;</span><br><span class="line">             try &#123;</span><br><span class="line">                 //这是OptionMenu加载菜单的Builder，android.support.v7.view.menu.MenuBuilder</span><br><span class="line">                 //Class clazz = Class.forName(&quot;android.support.v7.view.menu.MenuBuilder&quot;);</span><br><span class="line">                 Method m = menu.getClass().getDeclaredMethod(</span><br><span class="line">                         &quot;setOptionalIconsVisible&quot;, Boolean.TYPE);</span><br><span class="line">                 m.setAccessible(true);</span><br><span class="line">                 m.invoke(menu, enable);</span><br><span class="line">             &#125; catch (Exception e) &#123;</span><br><span class="line">             &#125;</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure></li>
</ol>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">平心</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://pingxin0521.gitee.io/2019/04/30/Android-%E5%9F%BA%E7%A1%80-13/">https://pingxin0521.gitee.io/2019/04/30/Android-%E5%9F%BA%E7%A1%80-13/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://pingxin0521.gitee.io" target="_blank">平心de小屋</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Android/">Android</a></div><div class="post_share"><div class="social-share" data-image="https://i.loli.net/2020/05/08/gGE57HRvpcKPfDY.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2019/05/01/JavaScript-%E5%9F%BA%E7%A1%80-6/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://i.loli.net/2020/05/08/HjVAdIuT7bZJypS.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">JavaScript 流程控制</div></div></a></div><div class="next-post pull-right"><a href="/2019/04/30/Android-%E5%9F%BA%E7%A1%80-12/"><img class="next-cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://i.loli.net/2020/05/08/okfOw28KlZFbE7z.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Android  高级控件（二）</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2019/06/03/Android-基础-22/" title="Android  常见错误"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://i.loli.net/2020/05/08/vCnKyoFJZ1g4XYR.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2020-05-16</div><div class="title">Android  常见错误</div></div></a></div><div><a href="/2019/04/27/Android-基础-4/" title="Android 用户界面状态保存"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://i.loli.net/2020/05/08/gGE57HRvpcKPfDY.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2019-07-02</div><div class="title">Android 用户界面状态保存</div></div></a></div><div><a href="/2019/04/30/Android-基础-11/" title="Android  高级控件（一）"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://i.loli.net/2020/05/08/7dHvepmfYOLWTrX.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2019-07-02</div><div class="title">Android  高级控件（一）</div></div></a></div><div><a href="/2019/04/27/Android-基础-3/" title="Android  Intent和Application"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://i.loli.net/2020/05/08/gGE57HRvpcKPfDY.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2019-07-02</div><div class="title">Android  Intent和Application</div></div></a></div><div><a href="/2019/04/28/Android-基础-5/" title="Android 常用基本控件"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://i.loli.net/2020/05/08/vCnKyoFJZ1g4XYR.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2019-05-08</div><div class="title">Android 常用基本控件</div></div></a></div><div><a href="/2019/04/30/Android-基础-9/" title="Android 事件处理"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://i.loli.net/2020/05/08/HjVAdIuT7bZJypS.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2019-05-08</div><div class="title">Android 事件处理</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://s2.ax1x.com/2020/02/11/1ovw6J.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">平心</div><div class="author-info__description">年轻人的life、learn and think</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">449</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">77</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">68</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/hanyunpeng0521"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/hanyunpeng0521" target="_blank" title="Github"><i class="fa fa-github"></i></a><a class="social-icon" href="mailto:m13839441583@163.com" target="_blank" title="Email"><i class="fa fa-envelope"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title=""><i class="fa fa-rss"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">为什么呢？开始提问吧</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-number">1.1.</span> <span class="toc-text">常用方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8XML%E5%AE%9A%E4%B9%89Menu"><span class="toc-number">1.2.</span> <span class="toc-text">使用XML定义Menu</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#OptionsMenu"><span class="toc-number">2.</span> <span class="toc-text">OptionsMenu</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%B8%80%EF%BC%9A"><span class="toc-number">2.1.</span> <span class="toc-text">方法一：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%BA%8C%EF%BC%9A"><span class="toc-number">2.2.</span> <span class="toc-text">方法二：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ContextMenu"><span class="toc-number">3.</span> <span class="toc-text">ContextMenu</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%AD%90%E8%8F%9C%E5%8D%95%E6%AD%A5%E9%AA%A4%EF%BC%9A"><span class="toc-number">3.1.</span> <span class="toc-text">创建子菜单步骤：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B"><span class="toc-number">3.2.</span> <span class="toc-text">示例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PopupMenu"><span class="toc-number">4.</span> <span class="toc-text">PopupMenu</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B-1"><span class="toc-number">4.1.</span> <span class="toc-text">示例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B3%E4%BA%8E%E8%8F%9C%E5%8D%95%E7%9A%84%E5%88%9B%E5%BB%BA%E8%AF%B4%E6%98%8E"><span class="toc-number">5.</span> <span class="toc-text">关于菜单的创建说明</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B3%E4%BA%8E%E8%8F%9C%E5%8D%95%E5%9B%BE%E7%89%87%E7%9A%84%E6%98%BE%E7%A4%BA%E9%97%AE%E9%A2%98"><span class="toc-number">5.1.</span> <span class="toc-text">关于菜单图片的显示问题</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/05/15/node-2-4/" title="Egg.js -- 为企业级框架和应用而生"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://i.loli.net/2020/05/08/okfOw28KlZFbE7z.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Egg.js -- 为企业级框架和应用而生"/></a><div class="content"><a class="title" href="/2021/05/15/node-2-4/" title="Egg.js -- 为企业级框架和应用而生">Egg.js -- 为企业级框架和应用而生</a><time datetime="2021-05-15T10:18:59.000Z" title="发表于 2021-05-15 18:18:59">2021-05-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/04/30/node-2-3/" title="Koa -- 基于Node.js平台的下一代Web开发框架"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://i.loli.net/2020/05/08/HjVAdIuT7bZJypS.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Koa -- 基于Node.js平台的下一代Web开发框架"/></a><div class="content"><a class="title" href="/2021/04/30/node-2-3/" title="Koa -- 基于Node.js平台的下一代Web开发框架">Koa -- 基于Node.js平台的下一代Web开发框架</a><time datetime="2021-04-30T10:18:59.000Z" title="发表于 2021-04-30 18:18:59">2021-04-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/04/01/node-2-1/" title="Node.JS web开发前置知识"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://i.loli.net/2020/05/08/gGE57HRvpcKPfDY.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Node.JS web开发前置知识"/></a><div class="content"><a class="title" href="/2021/04/01/node-2-1/" title="Node.JS web开发前置知识">Node.JS web开发前置知识</a><time datetime="2021-04-01T03:18:59.000Z" title="发表于 2021-04-01 11:18:59">2021-04-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/12/26/%E5%91%A8%E8%AE%B0-10-1/" title="第十一周--谷歌浏览器插件"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://i.loli.net/2020/05/08/gGE57HRvpcKPfDY.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="第十一周--谷歌浏览器插件"/></a><div class="content"><a class="title" href="/2020/12/26/%E5%91%A8%E8%AE%B0-10-1/" title="第十一周--谷歌浏览器插件">第十一周--谷歌浏览器插件</a><time datetime="2020-12-26T10:18:59.000Z" title="发表于 2020-12-26 18:18:59">2020-12-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/12/26/%E5%91%A8%E8%AE%B0-10-0/" title="第十一周--浏览器技术"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://i.loli.net/2020/05/08/vCnKyoFJZ1g4XYR.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="第十一周--浏览器技术"/></a><div class="content"><a class="title" href="/2020/12/26/%E5%91%A8%E8%AE%B0-10-0/" title="第十一周--浏览器技术">第十一周--浏览器技术</a><time datetime="2020-12-26T06:18:59.000Z" title="发表于 2020-12-26 14:18:59">2020-12-26</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2021 By 平心</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: '4lfIXzqxaC1ONs0MJO4oHu07-gzGzoHsz',
      appKey: 'qw99Bw8FD0KVKU9m457CwWsr',
      placeholder: 'Please leave your footprints',
      avatar: 'monsterid',
      meta: 'nick,mail,link'.split(','),
      pageSize: '10',
      lang: 'zh-CN',
      recordIP: true,
      serverURLs: '',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: true,
      path: window.location.pathname,
      requiredFields: ["nick,mail"],
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>