---
title: 常用算法--分支限界算法 (四)
date: 2020-06-27 13:18:59
tags:
 - 算法
categories:
 - 算法
---

贪心算法、分治算法、动态规划算法、回溯算法、分支限界算法都是一种编程思想，深入理解这些编程思想，我们也可以根据实际情况设计自己的算法。

<!--more-->

### 分支限界算法

类似于回溯法，也是一种在问题的解空间树T上搜索问题解的算法。但在一般情况下，分支限界法与回溯法的求解目标不同。**回溯法的求解目标是找出T中满足约束条件的所有解**，而**分支限界法**的求解目标则是找出**满足约束条件的一个解**，或是在满足约束条件的解中找出使某一目标函数值达到**极大或极小的解**，即在某种意义下的**最优解**。

分支限界算法是按照广度优先的方式对解空间树（状态空间树）进行搜索，从而求得最优解的算法。在搜索的过程中，采用**限界函数**（bound function）估算所有子节点的目标函数的可能取值，从而选择使目标函数取极值（极大值或者极小值）的节点作为扩展结点（如果限界值没有超过目前的最优解，则剪枝）进行下一步搜索（重复 BFS -> 计算所有子节点限界 -> 选择最优子节点作为扩展结点的过程），从而不断调整搜索的方向，尽快找到问题的最优解。

（ps：回溯算法求出满足约束的所有可行解，分支限界求出满足约束的解中使得目标函数达到极值的最优解）

分支限界的思想类似于：图的广度优先搜索，树的层序遍历。

#### 分支限界算法和回溯算法的不同点

- 分支限界算法与回溯算法在子结点的扩展方式上不同：

  回溯一般采用轮流遍历子节点的方式扩展结点。

  分支限界则采用活结点的方式，一次性对所有的可行子节点进行扩展，估算子节点目标函数的可能值，如果该子节点的目标函数值差于当前最优解，则丢弃；否则将其加入活叶子表，依次从表中选取使目标函数取极值的节点作为当前的扩展结点。重复这一过程，直到找到最优解。

- 分支限界算法与回溯算法在解空间树的搜索方式上不同：

  回溯采用深度优先搜索的方式去搜索解空间树。搜索过程中，对所有的子节点轮流进行深度优先搜索，一旦发现有不满足约束的子节点，则对该子节点为根的子树进行剪枝；否则就从该子节点深度优先搜索，直到搜索到一个满足约束条件的叶子节点，即求得一个可行解。

  分支限界采用广度优先搜索的方式去搜索解空间树。搜索过程中，先生成所有的子节点（分支），然后对所有分支计算一个函数值（限界），并根据这些函数值（计算出的上界或者下界），从中选择一个使目标函数最优（限界最优）的子节点作为扩展结点，使得搜索朝着最优解的方向快速推进，从而很快求得一个最优解。（**ps：我的理解是每次从所有子节点中找出一个最有潜力的，作为扩展结点进行下一次的BFS**）

#### 分支限界算法的一般步骤

1. 将问题的解空间转化为图或者树的结构表示，维护一张活叶子表（可以是优先队列）。
2. 初始将根节点计算一个限界后加入活叶子表。
3. 当活叶子表不为空时，**从活叶子表中取出一个限界最优的结点作为扩展结点，并将该节点去除出表**。当活结点表为空时，算法结束。
4. 判断当前的扩展结点是否可以满足所有约束，并且得到一个可行解（该扩展结点是叶子节点）。
   - 如果是，判断优于当前最优解后，记录并更新最优解，随后将当前最优解与所有活叶子节点的限界做比较，**对于限界差于最优解的活叶子结点，去除出活叶子表**，并返回（3）。
   - 如果不是，则进入（5）

5. 计算扩展结点的所有子节点是否满足约束条件，对于不满足约束条件的子节点，将以该节点为根的子树剪枝（丢弃）。
6. 根据限界函数，计算该节点满足约束的所有子节点的限界。**对于限界差于当前最优解的子节点**（ps：废了，没潜力），**将以该子节点为根的子树丢弃**；**对于限界优于当前最优解的子节点**（ps：还有潜力），**将这些潜力节点作为活叶子结点添加到活叶子表**，并返回（3）

#### 难点

1. 解空间的构造，即状态空间树的构造方法（节点的生成顺序）
2. 剪枝函数的确定，即约束规则的确定
3. 限界函数的确定，边界的评估方法

